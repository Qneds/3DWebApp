(this["webpackJsonp3d-web-edit"]=this["webpackJsonp3d-web-edit"]||[]).push([[0],{167:function(e,t,i){},194:function(e,t,i){},239:function(e,t,i){},240:function(e,t,i){},287:function(e,t){},288:function(e,t,i){},289:function(e,t,i){},412:function(e,t,i){"use strict";i.r(t);var n=i(1),a=i.n(n),s=i(34),r=i.n(s),o=(i(239),i(5)),c=(i(240),i(241),i(82)),l=i(83),u=i(201),h=i(443),d=i(24),f=i(2),g=function(e){var t=e.bordersEnabled;t||(t="wens");var i=e.backgroundColor;i||(i="#FFFFFF");var n=e.borderColor;n||(n="#000000");var a=e.borderWidth;return a||(a=0),Object(f.jsx)("div",{style:Object(d.a)({backgroundColor:i,borderStyle:"solid",borderColor:n,borderTopWidth:/(n|N)/.test(t)?"".concat(a,"px"):"0px",borderRightWidth:/(e|E)/.test(t)?"".concat(a,"px"):"0px",borderBottomWidth:/(s|S)/.test(t)?"".concat(a,"px"):"0px",borderLeftWidth:/(w|W)/.test(t)?"".concat(a,"px"):"0px"},e.style),children:e.children})};function v(e){return Object(f.jsx)("style",{type:"text/css",children:"\n                .btn-gui,\n                .btn-secondary {\n                    border-radius: 0px;\n                    border-width: 0px;\n                    background-color: ".concat(e.backgroundColor,";\n                    color: ").concat(e.primaryColor,";\n                }\n                .btn-gui:hover,\n                .btn-secondary:hover {\n                    background-color: ").concat(e.backgroundColor,";\n                    color: ").concat(e.accentColor,";\n                    box-shadow: none;\n                }\n\n                .btn-gui:focus,\n                .btn-gui:active,\n                .btn-secondary.active,\n                .btn-secondary.active:focus,\n                .btn-secondary.dropdown-toggle:focus,\n                dropdown-toggle btn btn-secondary {\n                    background-color: ").concat(e.accentColor,";\n                    color: ").concat(e.backgroundColor,";\n                    border-width: 0px;\n                    box-shadow: none;\n                    height: 100%;\n                }\n\n                .dropdown-menu {\n\n                }\n\n                .dropdown-item {\n                    \n                }\n            ")})}var b=Object(n.createContext)(null),j=i(202),m=i(456),O=i(457),p=i(458),y=i(432),x=i(99),k=i(206),w=i(205),S=i(451),M=i(452),C=i(100),P=function(e){var t=Object(n.useRef)(null),i=Object(n.useState)(!1),a=Object(o.a)(i,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){void 0===e.active&&r(!1)}),[s]),Object(f.jsxs)(j.a,{className:"btn-gui ".concat(e.className?e.className:""),onClick:e.onClick,innerRef:e.buttonRef?e.buttonRef:t,style:e.style,active:void 0!==e.active?e.active:s,children:[Object(f.jsx)("span",{style:Object(d.a)({marginRight:e.text?"10px":"0px",display:"inline",width:"120%",height:"120%"},e.style),children:e.ico}),e.text&&Object(f.jsx)("span",{style:{display:"inline"},children:e.text})]})},T=function(e){var t=Object(n.useState)(!1),i=Object(o.a)(t,2),a=i[0],s=i[1];return Object(f.jsxs)(m.a,{isOpen:void 0===e.isOpen?a:e.isOpen,toggle:function(){void 0===e.toggle?s((function(e){return!e})):e.toggle()},innerRef:e.buttonRef,onClick:e.onClick,className:"btn-gui",children:[Object(f.jsxs)(O.a,{caret:!0,children:[Object(f.jsx)("span",{style:{marginRight:"10px",display:"inline",width:"120%",height:"120%"},children:e.ico}),Object(f.jsx)("span",{style:{display:"inline"},children:e.text})]}),Object(f.jsx)(p.a,{children:e.children})]})},E=function(e){var t=e.text,i=e.onClick,n=e.active,a=e.style,s=e.className,r=e.buttonRef;return Object(f.jsx)(P,{text:t,buttonRef:r,className:s,style:a,ico:Object(f.jsx)(x.a,{}),onClick:i,active:n})},z=function(e){var t=e.text,i=e.onClick,n=e.active,a=e.style,s=e.className,r=e.buttonRef;return Object(f.jsx)(P,{text:t,buttonRef:r,className:s,style:a,ico:Object(f.jsx)(w.a,{}),onClick:i,active:n})},I=function(e){var t=e.text,i=e.onClick,n=e.active,a=e.style,s=e.className,r=e.buttonRef;return Object(f.jsx)(P,{text:t,buttonRef:r,className:s,style:a,ico:Object(f.jsx)(k.a,{}),onClick:i,active:n})},R=function(e){var t=e.text,i=e.onClick,n=e.active,a=e.style,s=e.className,r=e.buttonRef;return Object(f.jsx)(P,{text:t,buttonRef:r,className:s,style:a,ico:Object(f.jsx)(C.b,{}),onClick:i,active:n})},A=function(e){var t=Object(n.useContext)(b);return Object(f.jsx)(y.a,Object(d.a)(Object(d.a)({},e),{},{className:"input-property-style ".concat(e.className?e.className:""),style:Object(d.a)({color:null===t||void 0===t?void 0:t.colorMode.primaryColor,backgroundColor:e.disabled?"grey":null===t||void 0===t?void 0:t.colorMode.secondaryColor,borderColor:null===t||void 0===t?void 0:t.colorMode.accentColor},e.style)}))},F=function(e){var t=Object(n.useContext)(b);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(y.a,Object(d.a)(Object(d.a)({},e),{},{className:"input-property-style ".concat(e.className?e.className:""),style:Object(d.a)({color:null===t||void 0===t?void 0:t.colorMode.primaryColor,backgroundColor:e.disabled?"grey":null===t||void 0===t?void 0:t.colorMode.secondaryColor,borderColor:null===t||void 0===t?void 0:t.colorMode.accentColor},e.style)})),Object(f.jsx)(j.a,{className:"ms-2 p-2",color:"success",onClick:e.onConfirm,children:"Confirm"})]})},B=function(e){var t=Object(n.useContext)(b);return Object(f.jsx)(S.a,Object(d.a)({sx:{color:null===t||void 0===t?void 0:t.colorMode.accentColor,"&.Mui-checked":{color:null===t||void 0===t?void 0:t.colorMode.accentColor},"&.Mui-disabled":{color:null===t||void 0===t?void 0:t.colorMode.secondaryColor}}},e))},L=function(e){var t=Object(n.useContext)(b);return Object(f.jsx)(M.a,Object(d.a)({sx:{color:null===t||void 0===t?void 0:t.colorMode.accentColor,height:"0.5em","& .MuiSlider-rail":{color:null===t||void 0===t?void 0:t.colorMode.secondaryColor,borderColor:"black",borderWidth:"1px",borderStyle:"solid"},"& .MuiSlider-track":{color:null===t||void 0===t?void 0:t.colorMode.accentColor,borderColor:"black",borderWidth:"1px",borderStyle:"solid"},"& .MuiSlider-thumb":{borderColor:"black",borderWidth:"1px",borderStyle:"solid","&.Mui-focusVisible, &:hover":{boxShadow:"0px 0px 0px 8px \n              ".concat(null===t||void 0===t?void 0:t.colorMode.accentColor,"29")},"&.Mui-active":{boxShadow:"0px 0px 0px 14px \n              ".concat(null===t||void 0===t?void 0:t.colorMode.accentColor,"29")}},"& .MuiSlider-mark":{display:"none"},"& .MuiSlider-markLabel":{color:null===t||void 0===t?void 0:t.colorMode.primaryColor}}},e))},N=function(e){var t;Object(n.useContext)(b);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(L,Object(d.a)({},e)),Object(f.jsx)(A,{bsSize:"sm",value:null===(t=e.value)||void 0===t?void 0:t.toString(),disabled:!0,style:{height:"50%",width:"50%",marginLeft:"1em"}})]})},V=function(e){return Object(f.jsx)("div",{style:Object(d.a)({display:"flex",flexGrow:1,flexDirection:"column"},e.style),className:e.className,children:e.children})},G=function(e){return Object(f.jsx)("div",{style:Object(d.a)({display:"flex",flexGrow:1,flexDirection:"row"},e.style),className:e.className,children:e.children})},W=function(e){return Object(f.jsxs)("div",{style:e.style,className:e.className,children:[e.disabled&&Object(f.jsx)("div",{className:"disabled-overlay"}),e.children]})},D=i(59),H=Object(n.createContext)(null),U=i(439),_=i(440),X=i(441),Y=i(442),q=i(7),Z=i(9),J=i(4),K=new(function(){function e(){Object(q.a)(this,e),this.gl=null,this.canvas=null}return Object(Z.a)(e,[{key:"initUtils",value:function(e,t){this.gl=e,this.canvas=t}},{key:"returnCanvas",value:function(){return this.canvas}},{key:"returnWebGLContext",value:function(){return this.gl}},{key:"clear",value:function(e,t,i,n){this.gl&&(this.gl.clearColor(e,t,i,n),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT))}},{key:"clearDepthBuffer",value:function(){this.gl&&this.gl.clear(this.gl.DEPTH_BUFFER_BIT)}},{key:"createBuffer",value:function(){return this.gl?this.gl.createBuffer():null}},{key:"bindArrayBuffer",value:function(e){this.gl&&this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e)}},{key:"unbindArrayBuffer",value:function(){this.gl&&this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}},{key:"enablePolygonOffset",value:function(e,t){this.gl&&(this.gl.enable(this.gl.POLYGON_OFFSET_FILL),this.gl.polygonOffset(e,t))}},{key:"disablePolygonOffset",value:function(){this.gl&&this.gl.disable(this.gl.POLYGON_OFFSET_FILL)}},{key:"addArrayBufferData",value:function(e){this.gl&&this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW)}},{key:"bindElementArrayBuffer",value:function(e){this.gl&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,e)}},{key:"unbindElementArrayBuffer",value:function(){this.gl&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}},{key:"addElementArrayBufferData",value:function(e){this.gl&&this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),this.gl.STATIC_DRAW)}},{key:"createVertexShader",value:function(){return this.gl?this.gl.createShader(this.gl.VERTEX_SHADER):null}},{key:"createFragmentShader",value:function(){return this.gl?this.gl.createShader(this.gl.FRAGMENT_SHADER):null}},{key:"addShaderSource",value:function(e,t){this.gl&&this.gl.shaderSource(e,t)}},{key:"compileShader",value:function(e){this.gl&&this.gl.compileShader(e)}},{key:"createShaderProgram",value:function(){return this.gl?this.gl.createProgram():null}},{key:"attachShaderToProgram",value:function(e,t){this.gl&&this.gl.attachShader(e,t)}},{key:"linkProgram",value:function(e){this.gl&&this.gl.linkProgram(e)}},{key:"useProgram",value:function(e){this.gl&&this.gl.useProgram(e)}},{key:"getAttribLocation",value:function(e,t){return this.gl?this.gl.getAttribLocation(e,t):-1}},{key:"enableVertexAttribArray",value:function(e){return!!this.gl&&(this.gl.enableVertexAttribArray(e),!0)}},{key:"pointToAttribute",value:function(e,t){this.gl&&this.gl.vertexAttribPointer(e,t,this.gl.FLOAT,!1,0,0)}},{key:"uploadVec3f",value:function(e,t){this.gl&&this.gl.uniform3fv(e,t)}},{key:"uploadVec4f",value:function(e,t){this.gl&&this.gl.uniform4fv(e,t)}},{key:"uploadFloat",value:function(e,t){this.gl&&this.gl.uniform1f(e,t)}},{key:"uploadInt",value:function(e,t){this.gl&&this.gl.uniform1i(e,t)}},{key:"uploadBool",value:function(e,t){this.gl&&this.gl.uniform1i(e,t?1:0)}},{key:"uploadMatrix4fv",value:function(e,t){this.gl&&this.gl.uniformMatrix4fv(e,!1,t)}},{key:"getUniformLocation",value:function(e,t){return this.gl?this.gl.getUniformLocation(e,t):null}},{key:"viewport",value:function(){this.gl&&this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}},{key:"enableDepthTest",value:function(e){this.gl&&(e?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST))}},{key:"uploadDataToBuffer",value:function(e,t){this.bindArrayBuffer(e),this.addArrayBufferData(t),this.unbindArrayBuffer()}},{key:"uploadElementDataToBuffer",value:function(e,t){this.bindElementArrayBuffer(e),this.addElementArrayBufferData(t),this.unbindElementArrayBuffer()}},{key:"drawElements",value:function(e,t){this.gl&&this.gl.drawElements(e,t,this.gl.UNSIGNED_SHORT,0)}},{key:"drawElementsTriangle",value:function(e){this.gl&&this.drawElements(this.gl.TRIANGLES,e)}},{key:"drawElementsEdge",value:function(e){this.gl&&this.drawElements(this.gl.LINES,e)}},{key:"drawElementsPoint",value:function(e){this.gl&&this.drawElements(this.gl.POINTS,e)}},{key:"drawArrays",value:function(e,t){this.gl&&this.gl.drawArrays(e,0,t)}},{key:"drawArraysTriangle",value:function(e){this.gl&&this.drawArrays(this.gl.TRIANGLES,e)}},{key:"drawArraysEdge",value:function(e){this.gl&&this.drawArrays(this.gl.LINES,e)}},{key:"drawArraysPoint",value:function(e){this.gl&&this.drawArrays(this.gl.POINTS,e)}}]),e}()),Q=function(){function e(t){Object(q.a)(this,e),this.point=void 0,this.vertexBuffer=null,this.point=t,this.vertexBuffer=K.createBuffer(),this.recalculateBufferData()}return Object(Z.a)(e,[{key:"getCords",value:function(){return this.point}},{key:"setCords",value:function(e){this.point=J.d.copy(this.point,e)}},{key:"deepCompare",value:function(e){return this.point[0]===e.point[0]&&this.point[1]===e.point[1]&&this.point[2]===e.point[2]}},{key:"raycastPoint",value:function(e,t){var i=J.a.create();J.a.identity(i),J.a.translate(i,i,this.point),J.a.multiply(i,t,i);var n=J.d.create();J.a.getTranslation(n,i);var a=e.getRay().getDirection(),s=e.getRay().getOrigin(),r=J.d.create(),o=J.d.sub(r,n,s),c=J.d.dot(o,a);if(c>0){var l=J.d.create();if(J.d.scale(l,a,c),J.d.length(J.d.sub(r,o,l))<c*e.getAreaRange()*.1)return{point:this,distance:c}}return null}},{key:"drawPoint",value:function(e){this.vertexBuffer&&(e.use(),K.bindArrayBuffer(this.vertexBuffer),e.enablePosition(),K.drawArraysPoint(1))}},{key:"recalculateBufferData",value:function(){this.vertexBuffer&&K.uploadDataToBuffer(this.vertexBuffer,this.point)}},{key:"copy",value:function(){return new e(J.d.fromValues(this.point[0],this.point[1],this.point[2]))}}]),e}(),$=function(){function e(t,i){Object(q.a)(this,e),this.p1=void 0,this.p2=void 0,this.vertexBuffer=null,this.p1=t,this.p2=i,this.vertexBuffer=K.createBuffer(),this.recalculateBufferData()}return Object(Z.a)(e,[{key:"getPoints",value:function(){return[this.p1,this.p2]}},{key:"shallowEqual",value:function(e){return this.p1===e.p1&&this.p2===e.p2||this.p1===e.p2&&this.p2===e.p1}},{key:"drawEdge",value:function(e){this.vertexBuffer&&(e.use(),K.bindArrayBuffer(this.vertexBuffer),e.enablePosition(),K.drawArraysEdge(2))}},{key:"raycastEdge",value:function(e,t){var i=J.d.create(),n=J.d.create(),a=J.a.create();J.a.identity(a),J.a.translate(a,a,this.p1.getCords()),J.a.multiply(a,t,a),J.a.getTranslation(i,a),J.a.identity(a),J.a.translate(a,a,this.p2.getCords()),J.a.multiply(a,t,a),J.a.getTranslation(n,a);var s=J.d.create(),r=i;J.d.sub(s,n,i),J.d.normalize(s,s);var o=J.d.create();if(J.d.cross(o,s,e.getRay().getDirection()),0===J.d.length(o))return null;var c=J.d.create();J.d.sub(c,i,e.getRay().getOrigin());var l=J.d.dot(o,c)/J.d.length(o);l=Math.abs(l);var u=J.d.create(),h=J.d.create();J.d.cross(h,s,o);var d=J.d.dot(J.d.sub(u,r,e.getRay().getOrigin()),h)/J.d.dot(e.getRay().getDirection(),h);if(d<=0)return null;if(l<d*e.getAreaRange()*.1){var f=J.d.create(),g=J.d.create();if(J.d.cross(g,e.getRay().getDirection(),o),J.d.scale(u,s,J.d.dot(J.d.sub(u,e.getRay().getOrigin(),r),g)/J.d.dot(s,g)),J.d.add(f,r,u),J.d.length(J.d.sub(u,f,i))+J.d.length(J.d.sub(u,n,f))<=J.d.length(J.d.sub(u,n,i))+.1)return{edge:this,distance:d}}return null}},{key:"recalculateBufferData",value:function(){if(this.vertexBuffer){var e=this.p1.getCords(),t=this.p2.getCords();K.uploadDataToBuffer(this.vertexBuffer,[e[0],e[1],e[2],t[0],t[1],t[2]])}}},{key:"copy",value:function(){return new e(this.getPoints()[0].copy(),this.getPoints()[1].copy())}}]),e}(),ee=function(){function e(t){Object(q.a)(this,e),this.edges=void 0,this.vertexBuffer=void 0,this.edges=t,this.vertexBuffer=K.createBuffer(),this.recalculateBufferData()}return Object(Z.a)(e,[{key:"generateVertexesArray",value:function(){for(var e=[],t=new Array(this.edges.length).fill(!1),i=0;;){if(t.reduce((function(e,t){return e&&t}),!0))break;this.edges.forEach((function(i,n){if(!t[n]){var a=i.getPoints(),s=Object(o.a)(a,2),r=s[0],c=s[1],l=e.find((function(e){return e===r})),u=e.find((function(e){return e===c}));if(l||(l=r),u||(u=c),t[n]=!0,0===e.length)return e.push(l),void e.push(u);l===e[0]&&u!==e[e.length-1]?e.unshift(u):l===e[e.length-1]&&u!==e[0]?e.push(u):u===e[0]&&l!==e[e.length-1]?e.unshift(l):u===e[e.length-1]&&l!==e[0]?e.push(l):t[n]=!1}}));var n=t.filter((function(e){return e})).length;if(n===i)break;i=n}var a=[];return e.forEach((function(e){var t=e.getCords();a.push([t[0],t[1],t[2]])})),a.flat()}},{key:"getEdges",value:function(){return this.edges}},{key:"getPoints",value:function(){return[this.edges[0].getPoints()[0],this.edges[0].getPoints()[1],this.edges[1].getPoints()[0]!==this.edges[0].getPoints()[0]&&this.edges[1].getPoints()[0]!==this.edges[0].getPoints()[1]?this.edges[1].getPoints()[0]:this.edges[1].getPoints()[1]]}},{key:"drawFace",value:function(e){this.vertexBuffer&&(e.use(),K.bindArrayBuffer(this.vertexBuffer),e.enablePosition(),K.drawArraysTriangle(3))}},{key:"recalculateBufferData",value:function(){this.vertexBuffer&&K.uploadDataToBuffer(this.vertexBuffer,this.generateVertexesArray())}},{key:"raycastFace",value:function(e,t){var i=J.d.create(),n=J.d.create(),a=J.a.create(),s=J.a.create();J.a.invert(s,t);var r=J.d.create(),o=J.d.create(),c=this.edges[0].getPoints()[0].getCords(),l=this.edges[0].getPoints()[1].getCords(),u=this.edges[1].getPoints()[0]!==this.edges[0].getPoints()[0]&&this.edges[1].getPoints()[0]!==this.edges[0].getPoints()[1]?this.edges[1].getPoints()[0].getCords():this.edges[1].getPoints()[1].getCords();J.a.identity(a),J.a.translate(a,a,e.getRay().getOrigin()),J.a.multiply(a,s,a),J.a.getTranslation(r,a),J.a.identity(a),J.a.translate(a,a,e.getRay().getDirection()),a[15]=0,J.a.multiply(a,s,a),J.a.getTranslation(o,a);var h=J.d.create();J.d.cross(i,J.d.sub(h,l,c),J.d.sub(n,u,c)),J.d.normalize(i,i),J.d.dot(o,i)<0&&J.d.negate(i,i);var d=J.d.dot(c,i);J.d.negate(i,i);var f=J.d.dot(o,i);if(!f)return null;var g=-(J.d.dot(r,i)+d)/f;if(g<=0)return null;var v=J.d.create();J.d.copy(v,r),J.d.scale(n,o,g),J.d.add(v,v,n);var b=this.testSide(v,c,l,u);J.d.cross(n,J.d.sub(n,u,l),J.d.sub(h,v,l));var j=this.testSide(v,l,u,c);J.d.cross(n,J.d.sub(n,c,u),J.d.sub(h,v,u));var m=this.testSide(v,u,c,l);if(b&&j&&m){var O=J.d.create(),p=J.a.create();return J.a.invert(p,t),J.d.transformMat4(O,v,p),{face:this,distance:J.d.distance(O,e.getRay().getOrigin())}}return null}},{key:"testSide",value:function(e,t,i,n){var a=J.d.create(),s=J.d.create(),r=J.d.create(),o=J.d.create();return J.d.cross(r,J.d.sub(a,n,i),J.d.sub(s,e,i)),J.d.cross(o,J.d.sub(a,n,i),J.d.sub(s,t,i)),J.d.dot(r,o)>0}},{key:"copy",value:function(){var t=this,i=this.getPoints().map((function(e){return e.copy()}));return new e(this.edges.map((function(e){var n=e.getPoints(),a=t.getPoints().indexOf(n[0]),s=t.getPoints().indexOf(n[1]),r=i[a],o=i[s];return new $(r,o)})))}}]),e}(),te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;Object(q.a)(this,e),this.faces=[],this.edges=[],this.points=[],this.outerRadius=2,this.innerRadius=1,this.radialSegments=8,this.thetaStart=0,this.thetaLength=2*Math.PI,this.outerRadius=t,this.innerRadius=i,this.radialSegments=n,this.thetaStart=a,this.thetaLength=s,this.generateCircle()}return Object(Z.a)(e,[{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}},{key:"generateCircle",value:function(){for(var e=this,t=0,i=[],n=[],a=0;a<this.radialSegments;a++){var s=a/this.radialSegments*this.thetaLength+this.thetaStart,r=new Q([this.outerRadius*Math.cos(s),this.outerRadius*Math.sin(s),0]);this.points.push(r),i.push(t++);var o=new Q([this.innerRadius*Math.cos(s),this.innerRadius*Math.sin(s),0]);this.points.push(o),n.push(t++)}for(var c=function(t){var a=e.points[n[t]],s=e.points[n[(t+1)%e.radialSegments]],r=e.points[i[(t+1)%e.radialSegments]],o=e.points[i[t]],c=new $(a,s),l=e.edges.find((function(e){return e.shallowEqual(c)}));l?c=l:e.edges.push(c);var u=new $(s,o),h=e.edges.find((function(e){return e.shallowEqual(u)}));h?u=h:e.edges.push(u);var d=new $(o,a),f=e.edges.find((function(e){return e.shallowEqual(d)}));f?d=f:e.edges.push(d);var g=new $(s,r),v=e.edges.find((function(e){return e.shallowEqual(g)}));v?g=v:e.edges.push(g);var b=new $(r,o),j=e.edges.find((function(e){return e.shallowEqual(b)}));j?b=j:e.edges.push(b),e.faces.push(new ee([c,u,d])),e.faces.push(new ee([g,b,u]))},l=0;l<this.radialSegments;l++)c(l)}}]),e}(),ie=function(){function e(){Object(q.a)(this,e),this.outerRadius=2,this.innerRadius=1,this.radialSegments=8,this.thetaStart=0,this.thetaLength=2*Math.PI}return Object(Z.a)(e,[{key:"setOuterRadius",value:function(e){return this.outerRadius=e,this}},{key:"setInnerRadius",value:function(e){return this.innerRadius=e,this}},{key:"setRadialSegments",value:function(e){return this.radialSegments=e,this}},{key:"setThetaStart",value:function(e){return this.thetaStart=e,this}},{key:"setThetaLength",value:function(e){return this.thetaLength=e,this}},{key:"build",value:function(){return new te(this.outerRadius,this.innerRadius,this.radialSegments,this.thetaStart,this.thetaLength)}}]),e}(),ne=(new te,function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;Object(q.a)(this,e),this.faces=[],this.edges=[],this.points=[],this.radius=1,this.height=1,this.radialSegments=8,this.heightSegments=3,this.thetaStart=0,this.thetaLength=2*Math.PI,this.radius=t,this.height=i,this.radialSegments=Math.floor(n),this.heightSegments=Math.floor(a),this.thetaStart=s,this.thetaLength=r,this.generateTorso(),this.generateBase()}return Object(Z.a)(e,[{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}},{key:"generateBase",value:function(){var e=this,t=this.height/2,i=this.points.slice(0,this.radialSegments),n=new Q([0,-t,0]);this.points.push(n);for(var a=function(t){var a=new $(i[t],i[(t+1)%e.radialSegments]),s=e.edges.find((function(e){return e.shallowEqual(a)}));s||(e.edges.push(a),s=a);var r=new $(n,i[t]),o=new $(n,i[(t+1)%e.radialSegments]);e.edges.push(r),e.edges.push(o),e.faces.push(new ee([r,o,s]))},s=0;s<this.radialSegments;s++)a(s)}},{key:"generateTorso",value:function(){for(var e=this,t=0,i=[],n=this.height/2,a=0;a<=this.heightSegments-1;a++){for(var s=[],r=(this.heightSegments-a)/this.heightSegments,o=r*this.radius,c=0;c<=this.radialSegments;c++){var l=c/this.radialSegments*this.thetaLength+this.thetaStart,u=Math.sin(l),h=Math.cos(l);this.points.push(new Q([o*u,-r*this.height+n,o*h])),s.push(t++)}i.push(s)}for(var d=0;d<this.radialSegments;d++)for(var f=function(t){var n=i[t][d],a=i[t+1][d],s=i[t+1][d+1],r=i[t][d+1],o=e.points[n],c=e.points[a],l=e.points[s],u=e.points[r],h=new $(o,c),f=e.edges.find((function(e){return e.shallowEqual(h)}));f?h=f:e.edges.push(h);var g=new $(c,u),v=e.edges.find((function(e){return e.shallowEqual(g)}));v?g=v:e.edges.push(g);var b=new $(u,o),j=e.edges.find((function(e){return e.shallowEqual(b)}));j?b=j:e.edges.push(b);var m=new $(c,l),O=e.edges.find((function(e){return e.shallowEqual(m)}));O?m=O:e.edges.push(m);var p=new $(l,u),y=e.edges.find((function(e){return e.shallowEqual(p)}));y?p=y:e.edges.push(p),e.faces.push(new ee([h,g,b])),e.faces.push(new ee([m,p,g]))},g=0;g<this.heightSegments-1;g++)f(g);var v=this.points.slice(this.points.length-this.radialSegments),b=new Q([0,n,0]);this.points.push(b);for(var j=function(t){var i=new $(v[t],v[(t+1)%e.radialSegments]),n=e.edges.find((function(e){return e.shallowEqual(i)}));n||(e.edges.push(i),n=i);var a=new $(b,v[t]),s=new $(b,v[(t+1)%e.radialSegments]);e.edges.push(a),e.edges.push(s),e.faces.push(new ee([a,s,n]))},m=0;m<this.radialSegments;m++)j(m)}}]),e}()),ae=function(){function e(){Object(q.a)(this,e),this.radius=1,this.height=1,this.radialSegments=8,this.heightSegments=3,this.thetaStart=0,this.thetaLength=2*Math.PI}return Object(Z.a)(e,[{key:"setRadius",value:function(e){return this.radius=e,this}},{key:"setHeight",value:function(e){return this.height=e,this}},{key:"setRadialSegments",value:function(e){return this.radialSegments=e,this}},{key:"setHeightSegments",value:function(e){return this.heightSegments=e,this}},{key:"setThetaStart",value:function(e){return this.thetaStart=e,this}},{key:"setThetaLength",value:function(e){return this.thetaLength=e,this}},{key:"build",value:function(){return new ne(this.radius,this.height,this.radialSegments,this.heightSegments,this.thetaStart,this.thetaLength)}}]),e}(),se=(new ne,function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(q.a)(this,e),this.faces=[],this.edges=[],this.points=[],this.points=[new Q([t,i,n]),new Q([t,i,-n]),new Q([t,-i,n]),new Q([t,-i,-n]),new Q([-t,i,n]),new Q([-t,i,-n]),new Q([-t,-i,n]),new Q([-t,-i,-n])],this.edges=[new $(this.points[6],this.points[2]),new $(this.points[2],this.points[0]),new $(this.points[0],this.points[6]),new $(this.points[4],this.points[6]),new $(this.points[7],this.points[5]),new $(this.points[5],this.points[1]),new $(this.points[1],this.points[7]),new $(this.points[1],this.points[3]),new $(this.points[3],this.points[7]),new $(this.points[5],this.points[4]),new $(this.points[4],this.points[0]),new $(this.points[0],this.points[5]),new $(this.points[0],this.points[1]),new $(this.points[3],this.points[2]),new $(this.points[2],this.points[7]),new $(this.points[6],this.points[7]),new $(this.points[0],this.points[3]),new $(this.points[4],this.points[7])],this.faces=[new ee([this.edges[0],this.edges[1],this.edges[2]]),new ee([this.edges[2],this.edges[3],this.edges[10]]),new ee([this.edges[4],this.edges[5],this.edges[6]]),new ee([this.edges[6],this.edges[7],this.edges[8]]),new ee([this.edges[9],this.edges[10],this.edges[11]]),new ee([this.edges[11],this.edges[12],this.edges[5]]),new ee([this.edges[8],this.edges[13],this.edges[14]]),new ee([this.edges[14],this.edges[0],this.edges[15]]),new ee([this.edges[7],this.edges[12],this.edges[16]]),new ee([this.edges[16],this.edges[1],this.edges[13]]),new ee([this.edges[15],this.edges[3],this.edges[17]]),new ee([this.edges[17],this.edges[9],this.edges[4]])]}return Object(Z.a)(e,[{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}}]),e}()),re=function(){function e(){Object(q.a)(this,e),this.xHalfWidth=1,this.yHalfWidth=1,this.zHalfWidth=1}return Object(Z.a)(e,[{key:"setXHalfWidth",value:function(e){return this.xHalfWidth=e,this}},{key:"setYHalfWidth",value:function(e){return this.yHalfWidth=e,this}},{key:"setZHalfWidth",value:function(e){return this.zHalfWidth=e,this}},{key:"build",value:function(){return new se(this.xHalfWidth,this.yHalfWidth,this.zHalfWidth)}}]),e}(),oe=new se,ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;Object(q.a)(this,e),this.faces=[],this.edges=[],this.points=[],this.radiusTop=1,this.radiusBottom=1,this.height=1,this.radialSegments=8,this.heightSegments=1,this.openEnded=!1,this.thetaStart=0,this.thetaLength=2*Math.PI,this.radiusTop=t,this.radiusBottom=i,this.height=n,this.radialSegments=Math.floor(a),this.heightSegments=Math.floor(s),this.openEnded=r,this.thetaStart=o,this.thetaLength=c,this.generateTorso(),!1===this.openEnded&&(t>0&&this.generateCap(!0),i>0&&this.generateCap(!1))}return Object(Z.a)(e,[{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}},{key:"generateTorso",value:function(){for(var e=this,t=0,i=[],n=this.height/2,a=0;a<=this.heightSegments;a++){for(var s=[],r=a/this.heightSegments,o=r*(this.radiusBottom-this.radiusTop)+this.radiusTop,c=0;c<=this.radialSegments;c++){var l=c/this.radialSegments*this.thetaLength+this.thetaStart,u=Math.sin(l),h=Math.cos(l);this.points.push(new Q([o*u,-r*this.height+n,o*h])),s.push(t++)}i.push(s)}for(var d=0;d<this.radialSegments;d++)for(var f=function(t){var n=i[t][d],a=i[t+1][d],s=i[t+1][d+1],r=i[t][d+1],o=e.points[n],c=e.points[a],l=e.points[s],u=e.points[r],h=new $(o,c),f=e.edges.find((function(e){return e.shallowEqual(h)}));f?h=f:e.edges.push(h);var g=new $(c,u),v=e.edges.find((function(e){return e.shallowEqual(g)}));v?g=v:e.edges.push(g);var b=new $(u,o),j=e.edges.find((function(e){return e.shallowEqual(b)}));j?b=j:e.edges.push(b);var m=new $(c,l),O=e.edges.find((function(e){return e.shallowEqual(m)}));O?m=O:e.edges.push(m);var p=new $(l,u),y=e.edges.find((function(e){return e.shallowEqual(p)}));y?p=y:e.edges.push(p),e.faces.push(new ee([h,g,b])),e.faces.push(new ee([m,p,g]))},g=0;g<this.heightSegments;g++)f(g)}},{key:"generateCap",value:function(e){var t=this,i=this.height/2,n=(!0===e?this.radiusTop:this.radiusBottom,!0===e?1:-1),a=[];try{a=!0===e?this.points.slice(0,this.radialSegments):this.points.slice(this.points.length-this.radialSegments)}catch(c){return}var s=new Q([0,i*n,0]);this.points.push(s);for(var r=function(e){var i=new $(a[e],a[(e+1)%t.radialSegments]),n=t.edges.find((function(e){return e.shallowEqual(i)}));n||(t.edges.push(i),n=i);var r=new $(s,a[e]),o=new $(s,a[(e+1)%t.radialSegments]);t.edges.push(r),t.edges.push(o),t.faces.push(new ee([r,o,n]))},o=0;o<this.radialSegments;o++)r(o)}}]),e}(),le=function(){function e(){Object(q.a)(this,e),this.radiusTop=1,this.radiusBottom=1,this.height=1,this.radialSegments=8,this.heightSegments=1,this.openEnded=!1,this.thetaStart=0,this.thetaLength=2*Math.PI}return Object(Z.a)(e,[{key:"setRadiusTop",value:function(e){return this.radiusTop=e,this}},{key:"setRadiusBottom",value:function(e){return this.radiusBottom=e,this}},{key:"setHeight",value:function(e){return this.height=e,this}},{key:"setRadialSegments",value:function(e){return this.radialSegments=e,this}},{key:"setHeightSegments",value:function(e){return this.heightSegments=e,this}},{key:"setOpenEnded",value:function(e){return this.openEnded=e,this}},{key:"setThetaStart",value:function(e){return this.thetaStart=e,this}},{key:"setThetaLength",value:function(e){return this.thetaLength=e,this}},{key:"build",value:function(){return new ce(this.radiusTop,this.radiusBottom,this.height,this.radialSegments,this.heightSegments,this.openEnded,this.thetaStart,this.thetaLength)}}]),e}(),ue=(new ce,function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;Object(q.a)(this,e),this.faces=[],this.edges=[],this.points=[],a=Math.floor(a),s=Math.floor(s);for(var o=0;o<=a;o++)for(var c=0;c<=s;c++){var l=c/s*r,u=o/a*Math.PI*2;this.points.push(new Q([(i+n*Math.cos(u))*Math.cos(l),(i+n*Math.cos(u))*Math.sin(l),n*Math.sin(u)]))}for(var h=1;h<=a;h++)for(var d=function(e){var i=(s+1)*h+e-1,n=(s+1)*(h-1)+e-1,a=(s+1)*(h-1)+e,r=(s+1)*h+e,o=t.points[i],c=t.points[n],l=t.points[a],u=t.points[r],d=new $(o,c),f=t.edges.find((function(e){return e.shallowEqual(d)}));f?d=f:t.edges.push(d);var g=new $(c,u),v=t.edges.find((function(e){return e.shallowEqual(g)}));v?g=v:t.edges.push(g);var b=new $(u,o),j=t.edges.find((function(e){return e.shallowEqual(b)}));j?b=j:t.edges.push(b);var m=new $(c,l),O=t.edges.find((function(e){return e.shallowEqual(m)}));O?m=O:t.edges.push(m);var p=new $(l,u),y=t.edges.find((function(e){return e.shallowEqual(p)}));y?p=y:t.edges.push(p),t.faces.push(new ee([d,g,b])),t.faces.push(new ee([m,p,g]))},f=1;f<=s;f++)d(f)}return Object(Z.a)(e,[{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}}]),e}()),he=function(){function e(){Object(q.a)(this,e),this.radius=1,this.tube=.4,this.radialSegments=8,this.tubularSegments=6,this.arc=2*Math.PI}return Object(Z.a)(e,[{key:"setRadius",value:function(e){return this.radius=e,this}},{key:"setTube",value:function(e){return this.tube=e,this}},{key:"setRadialSegments",value:function(e){return this.radialSegments=e,this}},{key:"setTubularSegments",value:function(e){return this.tubularSegments=e,this}},{key:"setArc",value:function(e){return this.arc=e,this}},{key:"build",value:function(){return new ue(this.radius,this.tube,this.radialSegments,this.tubularSegments,this.arc)}}]),e}(),de=(new ue,new ie),fe=new ae,ge=new re,ve=new le,be=new he,je="Value must be greater than 0",me="Provided value is not an integer";function Oe(e,t,i){var n=parseFloat(e);return isNaN(n)?(t(!0),void i("Value is not a number")):n}var pe=function(e){return Object(f.jsxs)(U.a,{children:[Object(f.jsx)(_.a,{children:e.label}),Object(f.jsx)(y.a,{value:e.value,onChange:e.onChange,invalid:e.isInvalid}),Object(f.jsx)(X.a,{children:e.msgIfInvalid})]})},ye=function(e){var t=Object(n.useState)("None"),i=Object(o.a)(t,2),a=i[0],s=i[1];return Object(f.jsx)("div",{children:Object(f.jsxs)(Y.a,{children:[Object(f.jsxs)(U.a,{children:[Object(f.jsx)(_.a,{children:"Choose basic mesh"}),Object(f.jsxs)(y.a,{type:"select",name:"select",value:a,onChange:function(e){return s(e.target.value)},children:[Object(f.jsx)("option",{children:"None"}),Object(f.jsx)("option",{children:"Circle"}),Object(f.jsx)("option",{children:"Cone"}),Object(f.jsx)("option",{children:"Cube"}),Object(f.jsx)("option",{children:"Cylinder"}),Object(f.jsx)("option",{children:"Torus"})]})]}),function(){switch(a){case"Circle":return e.currentBuilderRef.current=de||void 0,Object(f.jsx)(xe,{markError:e.markError});case"Cone":return e.currentBuilderRef.current=fe||void 0,Object(f.jsx)(ke,{markError:e.markError});case"Cube":return e.currentBuilderRef.current=ge||void 0,Object(f.jsx)(we,{markError:e.markError});case"Cylinder":return e.currentBuilderRef.current=ve||void 0,Object(f.jsx)(Se,{markError:e.markError});case"Torus":return e.currentBuilderRef.current=be||void 0,Object(f.jsx)(Me,{markError:e.markError});default:return e.currentBuilderRef.current=null,Object(f.jsx)(f.Fragment,{})}}()]})})},xe=function(e){var t=Object(n.useState)("1"),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(""),d=Object(o.a)(h,2),g=d[0],v=d[1],b=Object(n.useState)("2"),j=Object(o.a)(b,2),m=j[0],O=j[1],p=Object(n.useState)(!1),x=Object(o.a)(p,2),k=x[0],w=x[1],S=Object(n.useState)(""),M=Object(o.a)(S,2),C=M[0],P=M[1],T=Object(n.useState)("4"),E=Object(o.a)(T,2),z=E[0],I=E[1],R=Object(n.useState)(!1),A=Object(o.a)(R,2),F=A[0],B=A[1],L=Object(n.useState)(""),N=Object(o.a)(L,2),V=N[0],G=N[1];Object(n.useEffect)((function(){de.setInnerRadius(1).setOuterRadius(2).setRadialSegments(4),e.markError(!1)}),[]),Object(n.useEffect)((function(){e.markError(l||k||F)}),[l,k,F]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(U.a,{children:[Object(f.jsx)(_.a,{children:"Inner radius"}),Object(f.jsx)(y.a,{value:a,onChange:function(e){u(!1),s(e.target.value);var t=Oe(e.target.value,u,v);void 0!==t&&(t>0?de.setInnerRadius(t):(u(!0),v(je)))},invalid:l}),Object(f.jsx)(X.a,{children:g})]}),Object(f.jsxs)(U.a,{children:[Object(f.jsx)(_.a,{children:"Outer radius"}),Object(f.jsx)(y.a,{value:m,onChange:function(e){w(!1),O(e.target.value);var t=Oe(e.target.value,w,P);void 0!==t&&(t>0?de.setOuterRadius(t):(w(!0),P(je)))},invalid:k}),Object(f.jsx)(X.a,{children:C})]}),Object(f.jsxs)(U.a,{children:[Object(f.jsx)(_.a,{children:"Number of radial segments"}),Object(f.jsx)(y.a,{value:z,onChange:function(e){B(!1),I(e.target.value);var t=Oe(e.target.value,B,G);void 0!==t&&(t>0?Number.isInteger(t)?de.setRadialSegments(t):(B(!0),G(me)):(B(!0),G(je)))},invalid:F}),Object(f.jsx)(X.a,{children:V})]})]})},ke=function(e){var t=Object(n.useState)("2"),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(""),d=Object(o.a)(h,2),g=d[0],v=d[1],b=Object(n.useState)("1"),j=Object(o.a)(b,2),m=j[0],O=j[1],p=Object(n.useState)(!1),y=Object(o.a)(p,2),x=y[0],k=y[1],w=Object(n.useState)(""),S=Object(o.a)(w,2),M=S[0],C=S[1],P=Object(n.useState)("4"),T=Object(o.a)(P,2),E=T[0],z=T[1],I=Object(n.useState)(!1),R=Object(o.a)(I,2),A=R[0],F=R[1],B=Object(n.useState)(""),L=Object(o.a)(B,2),N=L[0],V=L[1],G=Object(n.useState)("1"),W=Object(o.a)(G,2),D=W[0],H=W[1],U=Object(n.useState)(!1),_=Object(o.a)(U,2),X=_[0],Y=_[1],q=Object(n.useState)(""),Z=Object(o.a)(q,2),J=Z[0],K=Z[1];Object(n.useEffect)((function(){fe.setHeight(2).setHeightSegments(1).setRadialSegments(4).setRadius(1),e.markError(!1)}),[]),Object(n.useEffect)((function(){e.markError(l||x||X||A)}),[l,x,A,X]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(pe,{label:"Height",value:a,onChange:function(e){u(!1),s(e.target.value);var t=Oe(e.target.value,u,v);void 0!==t&&(t>0?fe.setHeight(t):(u(!0),v(je)))},isInvalid:l,msgIfInvalid:g}),Object(f.jsx)(pe,{label:"Number of height segments",value:m,onChange:function(e){k(!1),O(e.target.value);var t=Oe(e.target.value,k,C);void 0!==t&&(t>0?Number.isInteger(t)?fe.setHeightSegments(t):(k(!0),C(me)):(k(!0),C(je)))},isInvalid:x,msgIfInvalid:M}),Object(f.jsx)(pe,{label:"Radius",value:D,onChange:function(e){Y(!1),H(e.target.value);var t=Oe(e.target.value,Y,K);void 0!==t&&(t>0?fe.setRadius(t):(Y(!0),K(je)))},isInvalid:X,msgIfInvalid:J}),Object(f.jsx)(pe,{label:"Number of radial segments",value:E,onChange:function(e){F(!1),z(e.target.value);var t=Oe(e.target.value,F,V);void 0!==t&&(t>0?Number.isInteger(t)?fe.setRadialSegments(t):(F(!0),V(me)):(F(!0),V(je)))},isInvalid:A,msgIfInvalid:N})]})},we=function(e){var t=Object(n.useState)("1"),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(""),d=Object(o.a)(h,2),g=d[0],v=d[1],b=Object(n.useState)("1"),j=Object(o.a)(b,2),m=j[0],O=j[1],p=Object(n.useState)(!1),y=Object(o.a)(p,2),x=y[0],k=y[1],w=Object(n.useState)(""),S=Object(o.a)(w,2),M=S[0],C=S[1],P=Object(n.useState)("1"),T=Object(o.a)(P,2),E=T[0],z=T[1],I=Object(n.useState)(!1),R=Object(o.a)(I,2),A=R[0],F=R[1],B=Object(n.useState)(""),L=Object(o.a)(B,2),N=L[0],V=L[1];Object(n.useEffect)((function(){ge.setXHalfWidth(1).setYHalfWidth(1).setZHalfWidth(1),e.markError(!1)}),[]),Object(n.useEffect)((function(){e.markError(l||x||A)}),[l,x,A]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(pe,{label:"Distance from center to X side",value:a,onChange:function(e){u(!1),s(e.target.value);var t=Oe(e.target.value,u,v);void 0!==t&&(t>0?ge.setXHalfWidth(t):(u(!0),v(je)))},isInvalid:l,msgIfInvalid:g}),Object(f.jsx)(pe,{label:"Distance from center to Y side",value:m,onChange:function(e){k(!1),O(e.target.value);var t=Oe(e.target.value,k,C);void 0!==t&&(t>0?ge.setYHalfWidth(t):(k(!0),C(je)))},isInvalid:x,msgIfInvalid:M}),Object(f.jsx)(pe,{label:"Distance from center to Z side",value:E,onChange:function(e){F(!1),z(e.target.value);var t=Oe(e.target.value,F,V);void 0!==t&&(t>0?ge.setZHalfWidth(t):(F(!0),V(je)))},isInvalid:A,msgIfInvalid:N})]})},Se=function(e){var t=Object(n.useState)("2"),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(""),d=Object(o.a)(h,2),g=d[0],v=d[1],b=Object(n.useState)("1"),j=Object(o.a)(b,2),m=j[0],O=j[1],p=Object(n.useState)(!1),x=Object(o.a)(p,2),k=x[0],w=x[1],S=Object(n.useState)(""),M=Object(o.a)(S,2),C=M[0],P=M[1],T=Object(n.useState)("4"),E=Object(o.a)(T,2),z=E[0],I=E[1],R=Object(n.useState)(!1),A=Object(o.a)(R,2),F=A[0],B=A[1],L=Object(n.useState)(""),N=Object(o.a)(L,2),V=N[0],G=N[1],W=Object(n.useState)("1"),D=Object(o.a)(W,2),H=D[0],X=D[1],Y=Object(n.useState)(!1),q=Object(o.a)(Y,2),Z=q[0],J=q[1],K=Object(n.useState)(""),Q=Object(o.a)(K,2),$=Q[0],ee=Q[1],te=Object(n.useState)("1"),ie=Object(o.a)(te,2),ne=ie[0],ae=ie[1],se=Object(n.useState)(!1),re=Object(o.a)(se,2),oe=re[0],ce=re[1],le=Object(n.useState)(""),ue=Object(o.a)(le,2),he=ue[0],de=ue[1],fe=Object(n.useState)(false),ge=Object(o.a)(fe,2),be=ge[0],ye=ge[1];Object(n.useEffect)((function(){ve.setHeight(2).setHeightSegments(1).setRadialSegments(4).setRadiusBottom(1).setRadiusTop(1).setOpenEnded(false),e.markError(!1)}),[]),Object(n.useEffect)((function(){e.markError(l||k||F||Z||oe)}),[l,k,oe,F,Z]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(pe,{label:"Height",value:a,onChange:function(e){u(!1),s(e.target.value);var t=Oe(e.target.value,u,v);void 0!==t&&(t>0?ve.setHeight(t):(u(!0),v(je)))},isInvalid:l,msgIfInvalid:g}),Object(f.jsx)(pe,{label:"Number of height segments",value:m,onChange:function(e){w(!1),O(e.target.value);var t=Oe(e.target.value,w,P);void 0!==t&&(t>0?Number.isInteger(t)?ve.setHeightSegments(t):(w(!0),P(me)):(w(!0),P(je)))},isInvalid:k,msgIfInvalid:C}),Object(f.jsx)(pe,{label:"Number of radial segments",value:z,onChange:function(e){B(!1),I(e.target.value);var t=Oe(e.target.value,B,G);void 0!==t&&(t>0?Number.isInteger(t)?ve.setRadialSegments(t):(B(!0),G(me)):(B(!0),G(je)))},isInvalid:F,msgIfInvalid:V}),Object(f.jsx)(pe,{label:"Radius at the top",value:H,onChange:function(e){J(!1),X(e.target.value);var t=Oe(e.target.value,J,ee);void 0!==t&&(t>0?ve.setRadiusTop(t):(J(!0),ee(je)))},isInvalid:Z,msgIfInvalid:$}),Object(f.jsx)(pe,{label:"Radius at the bottom",value:ne,onChange:function(e){ce(!1),ae(e.target.value);var t=Oe(e.target.value,ce,de);void 0!==t&&(t>0?ve.setRadiusBottom(t):(ce(!0),de(je)))},isInvalid:oe,msgIfInvalid:he}),Object(f.jsxs)(U.a,{children:[Object(f.jsx)(_.a,{children:"Open cylinder"}),Object(f.jsx)(y.a,{type:"checkbox",checked:be,onChange:function(){ye(!be),ve.setOpenEnded(!be)}})]})]})},Me=function(e){var t=Object(n.useState)("2"),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(""),d=Object(o.a)(h,2),g=d[0],v=d[1],b=Object(n.useState)("0.5"),j=Object(o.a)(b,2),m=j[0],O=j[1],p=Object(n.useState)(!1),y=Object(o.a)(p,2),x=y[0],k=y[1],w=Object(n.useState)(""),S=Object(o.a)(w,2),M=S[0],C=S[1],P=Object(n.useState)("4"),T=Object(o.a)(P,2),E=T[0],z=T[1],I=Object(n.useState)(!1),R=Object(o.a)(I,2),A=R[0],F=R[1],B=Object(n.useState)(""),L=Object(o.a)(B,2),N=L[0],V=L[1],G=Object(n.useState)("8"),W=Object(o.a)(G,2),D=W[0],H=W[1],U=Object(n.useState)(!1),_=Object(o.a)(U,2),X=_[0],Y=_[1],q=Object(n.useState)(""),Z=Object(o.a)(q,2),J=Z[0],K=Z[1];Object(n.useEffect)((function(){be.setRadius(2).setTube(.5).setRadialSegments(4).setTubularSegments(8),e.markError(!1)}),[]),Object(n.useEffect)((function(){e.markError(l||x||A||X)}),[l,x,X,A]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(pe,{label:"Torus radius",value:a,onChange:function(e){u(!1),s(e.target.value);var t=Oe(e.target.value,u,v);void 0!==t&&(t>0?be.setRadius(t):(u(!0),v(je)))},isInvalid:l,msgIfInvalid:g}),Object(f.jsx)(pe,{label:"Tube radius",value:m,onChange:function(e){k(!1),O(e.target.value);var t=Oe(e.target.value,k,C);void 0!==t&&(t>0?be.setTube(t):(k(!0),C(je)))},isInvalid:x,msgIfInvalid:M}),Object(f.jsx)(pe,{label:"Number of radial segments",value:E,onChange:function(e){F(!1),z(e.target.value);var t=Oe(e.target.value,F,V);void 0!==t&&(t>0?Number.isInteger(t)?be.setRadialSegments(t):(F(!0),V(me)):(F(!0),V(je)))},isInvalid:A,msgIfInvalid:N}),Object(f.jsx)(pe,{label:"Number of tubular segments",value:D,onChange:function(e){Y(!1),H(e.target.value);var t=Oe(e.target.value,Y,K);void 0!==t&&(t>0?Number.isInteger(t)?be.setTubularSegments(t):(Y(!0),K(me)):(Y(!0),K(je)))},isInvalid:X,msgIfInvalid:J})]})},Ce=i(23),Pe=i(22),Te=function(){function e(){Object(q.a)(this,e),this.listeners=[]}return Object(Z.a)(e,[{key:"subscribe",value:function(e){this.listeners.push(e)}},{key:"unsubscribe",value:function(e){this.listeners=this.listeners.filter((function(t){return t!==e}))}},{key:"getListeners",value:function(){return this.listeners}},{key:"refresh",value:function(){this.listeners=this.listeners.filter((function(e){return!(null===e||void 0===e)}))}}]),e}(),Ee=new(function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.apply(this,arguments)}return Object(Z.a)(i,[{key:"refresh",value:function(){this.getListeners().forEach((function(e){e.onRefresh()}))}}]),i}(Te)),ze=new(function(){function e(){Object(q.a)(this,e),this.world=null,this.selectedObject=null}return Object(Z.a)(e,[{key:"setWorld",value:function(e){this.world=e}},{key:"getWorld",value:function(){return this.world}},{key:"setSelectedObject",value:function(e){this.selectedObject=e,Ee.refresh()}},{key:"getSelectedObject",value:function(){return this.selectedObject}}]),e}()),Ie=function(e){return e*(Math.PI/180)},Re=function(e){return 180*e/Math.PI},Ae=function(e,t,i){var n=J.a.create();return J.a.identity(n),J.a.translate(n,n,e),J.a.rotateX(n,n,t[0]),J.a.rotateY(n,n,t[1]),J.a.rotateZ(n,n,t[2]),J.a.scale(n,n,i),n};function Fe(e,t){return e.filter((function(e){return t.includes(e)}))}function Be(e){var t=0;return e<-Math.PI&&(t=Math.floor((e+Math.PI)/2*Math.PI)),e>Math.PI&&(t=Math.ceil((e-Math.PI)/2*Math.PI)),e-=2*t*Math.PI}function Le(e){var t=0,i=0,n=0;return e.map((function(e){t+=e.getCords()[0],i+=e.getCords()[1],n+=e.getCords()[2]})),t/=e.length,i/=e.length,n/=e.length,new Q(J.d.fromValues(t,i,n))}var Ne,Ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1];Object(q.a)(this,e),this.positionInParent=void 0,this.orientationInParent=void 0,this.scaleInParent=void 0,this.transformationMatrix=void 0,this.positionInParent=t,this.orientationInParent=i,this.scaleInParent=n,this.transformationMatrix=Ae(t,i,n)}return Object(Z.a)(e,[{key:"updateTransformMatrix",value:function(){this.transformationMatrix=Ae(this.positionInParent,this.orientationInParent,this.scaleInParent)}},{key:"getPositionInParent",value:function(){return this.positionInParent}},{key:"getOrientationInParent",value:function(){return this.orientationInParent}},{key:"getScaleInParent",value:function(){return this.scaleInParent}},{key:"setPositionInParent",value:function(e){return J.d.copy(this.positionInParent,e),this.updateTransformMatrix(),this}},{key:"setOrientationInParent",value:function(e){return J.d.copy(this.orientationInParent,e),this.updateTransformMatrix(),this}},{key:"setScaleInParent",value:function(e){return J.d.copy(this.scaleInParent,e),this.updateTransformMatrix(),this}},{key:"getTransformationMatrix",value:function(){return this.transformationMatrix}}]),e}();!function(e){e[e.hitbox=0]="hitbox",e[e.face=1]="face",e[e.edge=2]="edge",e[e.point=4]="point"}(Ne||(Ne={}));var Ge=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ne.hitbox,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1;Object(q.a)(this,e),this.ray=void 0,this.obj=void 0,this.mode=void 0,this.recursion=void 0,this.areaRange=void 0,this.ray=t,this.obj=i,this.mode=n,this.recursion=a,this.areaRange=s}return Object(Z.a)(e,[{key:"cast",value:function(e){if(this.obj instanceof Ke){var t=J.a.create();return void 0!==e?J.a.copy(t,e):J.a.copy(t,this.obj.getTransform().getTransformationMatrix()),this.castObject3D(this.obj,t).filter((function(e){return null!==e}))}return console.log("not"),null}},{key:"castObject3D",value:function(e,t){var i=this,n=[];return n.push(e.raycast(this,t)),this.recursion&&e.getChildrenList().forEach((function(e){var a=J.a.create();J.a.mul(a,t,e.getTransform().getTransformationMatrix()),n=n.concat(i.castObject3D(e,a))})),n}},{key:"getMode",value:function(){return this.mode}},{key:"setMode",value:function(e){this.mode=e}},{key:"getRay",value:function(){return this.ray}},{key:"setRay",value:function(e){this.ray=e}},{key:"getRaycastable",value:function(){return this.obj}},{key:"setRaycastable",value:function(e){this.obj=e}},{key:"getAreaRange",value:function(){return this.areaRange}},{key:"setAreaRange",value:function(e){this.areaRange=e}}]),e}();Ge.STANDARD_AREA_RANGE=.1;var We=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1];Object(q.a)(this,e),this.origin=void 0,this.direction=void 0,this.origin=t,this.direction=i}return Object(Z.a)(e,[{key:"getOrigin",value:function(){return this.origin}},{key:"getDirection",value:function(){return this.direction}}]),e}();function De(e,t){var i=t.getPosition(),n=J.e.fromValues(e[0],e[1],1,1);J.e.transformMat4(n,n,t.getUnProjectMatrix());var a=n[3]?n[3]:1,s=J.d.fromValues(n[0]/a,n[1]/a,n[2]/a);return J.d.sub(s,s,i),J.d.normalize(s,s),new We(i,s)}var He={POSITION:"position",TEXTURE_COORDS:"textureCoords",NORMAL:"normal",TRANSFORMATION_MATRIX:"transformationMatrix",ALBEDO:"albedo",VIEW_MATRIX:"viewMatrix",PROJECTION_MATRIX:"projectionMatrix",LIGHT_POSITION:"lightPosition",LIGHT_COLOR:"lightColor",LIGHT_AMBIENT:"lightAmbient",DIFFUSE_TEXTURE:"diffuseTexture",HAS_DIFFUSE_TEXTURE:"hasDiffuseTexture"},Ue="\n  precision mediump float;\n  attribute vec3 ".concat(He.POSITION,";\n\n  varying vec3 surfaceNormal;\n  varying vec3 lightVector;\n\n  uniform mat4 ").concat(He.TRANSFORMATION_MATRIX,";\n  uniform mat4 ").concat(He.VIEW_MATRIX,";\n  uniform mat4 ").concat(He.PROJECTION_MATRIX,";\n  uniform vec3 ").concat(He.LIGHT_POSITION,";\n\n  vec4 getWorldPosition() {\n    return ").concat(He.PROJECTION_MATRIX," *\n      ").concat(He.VIEW_MATRIX," *\n      ").concat(He.TRANSFORMATION_MATRIX," *\n      vec4(").concat(He.POSITION,", 1.0);\n  }\n\n  void main(void) {\n    gl_Position = getWorldPosition();\n    gl_PointSize = 5.0;\n  }\n"),_e="\n  precision mediump float;\n\n  varying vec3 surfaceNormal;\n  varying vec3 lightVector;\n\n  uniform float ".concat(He.LIGHT_AMBIENT,";\n  uniform vec3 ").concat(He.LIGHT_COLOR,";\n\n  uniform vec4 ").concat(He.ALBEDO,";\n\n  float normalizedDot() {\n    vec3 unitNormal = normalize(surfaceNormal);\n    vec3 unitLightVector = normalize(lightVector);\n    return dot(unitNormal, unitLightVector);\n  }\n\n  vec4 getDiffuseTexture(){\n    return ").concat(He.ALBEDO,";\n    // return vec4(1.0, 1.0, 1.0, 1.0);\n  }\n\n  vec4 diffuseLighting(){\n    float brightness = max(normalizedDot(), \n      ").concat(He.LIGHT_AMBIENT,");\n    return vec4(").concat(He.LIGHT_COLOR,".rgb * brightness, 1.0);\n  }\n\n  void main(void) {\n    gl_FragColor = getDiffuseTexture();\n  }\n\n"),Xe=function(){function e(){Object(q.a)(this,e),this.program=null,this.positionAttribute=-1,this.transformationMatrixUniform=void 0,this.viewMatrixUniform=void 0,this.projectionMatrixUniform=void 0,this.albedoUniform=void 0,this.lightPositionUniform=void 0,this.lightAmbientUniform=void 0,this.lightColorUniform=void 0;var t=K.createVertexShader();if(t){K.addShaderSource(t,Ue),K.compileShader(t),this.compileStatus(t);var i=K.createFragmentShader();if(i){K.addShaderSource(i,_e),K.compileShader(i),this.compileStatus(i);var n=K.createShaderProgram();n&&(K.attachShaderToProgram(n,t),K.attachShaderToProgram(n,i),K.linkProgram(n),this.program=n,this.positionAttribute=K.getAttribLocation(n,He.POSITION),this.transformationMatrixUniform=K.getUniformLocation(n,He.TRANSFORMATION_MATRIX),this.viewMatrixUniform=K.getUniformLocation(n,He.VIEW_MATRIX),this.projectionMatrixUniform=K.getUniformLocation(n,He.PROJECTION_MATRIX),this.lightPositionUniform=K.getUniformLocation(n,He.LIGHT_POSITION),this.lightColorUniform=K.getUniformLocation(n,He.LIGHT_COLOR),this.lightAmbientUniform=K.getUniformLocation(n,He.LIGHT_AMBIENT),this.albedoUniform=K.getUniformLocation(n,He.ALBEDO))}}}return Object(Z.a)(e,[{key:"use",value:function(){this.program&&K.useProgram(this.program)}},{key:"compileStatus",value:function(e){var t=K.returnWebGLContext();t&&(t.getShaderParameter(e,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(e)))}},{key:"enablePosition",value:function(){K.enableVertexAttribArray(this.positionAttribute),K.pointToAttribute(this.positionAttribute,3)}},{key:"enableTransformationMatrix",value:function(e){K.uploadMatrix4fv(this.transformationMatrixUniform,e)}},{key:"enableViewProjectionMatrices",value:function(e,t){K.uploadMatrix4fv(this.viewMatrixUniform,e),K.uploadMatrix4fv(this.projectionMatrixUniform,t)}},{key:"enableAlbedo",value:function(e){K.uploadVec4f(this.albedoUniform,e)}},{key:"getProgram",value:function(){return this.program}}]),e}(),Ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new qe;Object(q.a)(this,e),this.faceMaterial=void 0,this.edgeMaterial=void 0,this.pointMaterial=void 0,this.faceMaterial=t,this.edgeMaterial=i,this.pointMaterial=n}return Object(Z.a)(e,[{key:"getFaceMaterial",value:function(){return this.faceMaterial}},{key:"setFaceMaterial",value:function(e){this.faceMaterial=e}},{key:"getEdgeMaterial",value:function(){return this.edgeMaterial}},{key:"setEdgeMaterial",value:function(e){this.edgeMaterial=e}},{key:"getPointMaterial",value:function(){return this.pointMaterial}},{key:"setPointMaterial",value:function(e){this.pointMaterial=e}}]),e}(),qe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xe,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1,1];Object(q.a)(this,e),this.shader=void 0,this.color=void 0,this.shader=t,this.color=i}return Object(Z.a)(e,[{key:"enableMaterial",value:function(){this.shader.enableAlbedo(this.color)}},{key:"getShader",value:function(){return this.shader}},{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}}]),e}(),Ze=new(function(){function e(){Object(q.a)(this,e),this.selectedObjMat=null,this.selectedFaceMat=null,this.selectedEdgeMat=null,this.selectedPointMat=null,this.editingModeObjectMat=null}return Object(Z.a)(e,[{key:"init",value:function(){this.selectedObjMat=new Ye,this.selectedObjMat.getFaceMaterial().setColor([1,158/255,89/255,1]),this.selectedObjMat.getEdgeMaterial().setColor([214/255,89/255,0,1]),this.selectedFaceMat=new Ye,this.selectedFaceMat.getFaceMaterial().setColor([1,158/255,89/255,1]),this.selectedEdgeMat=new Ye,this.selectedEdgeMat.getEdgeMaterial().setColor([214/255,89/255,0,1]),this.selectedPointMat=new Ye,this.selectedPointMat.getPointMaterial().setColor([186/255,105/255,47/255,1]),this.editingModeObjectMat=new Ye,this.editingModeObjectMat.getFaceMaterial().setColor([1,1,1,1]),this.editingModeObjectMat.getEdgeMaterial().setColor([.5,.5,.5,1]),this.editingModeObjectMat.getPointMaterial().setColor([0,0,0,1])}},{key:"getSelectedObjectMaterial",value:function(){return this.selectedObjMat}},{key:"getSelectedFaceMaterial",value:function(){return this.selectedFaceMat}},{key:"getSelectedEdgeMaterial",value:function(){return this.selectedEdgeMat}},{key:"getSelectedPointMaterial",value:function(){return this.selectedPointMat}},{key:"getEditModeObjectMaterial",value:function(){return this.editingModeObjectMat}}]),e}());function Je(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=i.length,a=0;a<e;a++)t+=i.charAt(Math.floor(Math.random()*n));return t}var Ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ve,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(q.a)(this,e),this.parent=void 0,this.children=void 0,this.transform=void 0,this.material=void 0,this.mesh=void 0,this.isSelected=!1,this.id=void 0,this.name=void 0,this.parent=i,this.children=[],this.transform=t,this.material=new Ye,this.material.getEdgeMaterial().setColor([.5,.5,.5,1]),this.material.getPointMaterial().setColor([0,0,0,1]),this.mesh=n,this.id=Date.now()+" "+Je(10),this.name=Je(10)}return Object(Z.a)(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getId",value:function(){return this.id}},{key:"select",value:function(){this.isSelected=!0}},{key:"unselect",value:function(){this.isSelected=!1}},{key:"raycast",value:function(e,t){if(e.getMode()===Ne.hitbox)return console.log("Implement hitbox on Obejct3D raycast"),null;if(null!==this.mesh){var i={hittedObject:this,hits:this.mesh.raycastMesh(e,t)};return i.hits.pointsHits.length<=0&&i.hits.edgesHits.length<=0&&i.hits.facesHits.length<=0?null:i}return null}},{key:"addChild",value:function(e){this.children.push(e),e.setParent(this)}},{key:"removeChild",value:function(e){var t=this.children.indexOf(e);-1!==t&&(this.children.splice(t,1),e.setParent(null))}},{key:"getChildrenList",value:function(){return this.children}},{key:"setParent",value:function(e){this.parent=e}},{key:"getParent",value:function(){return this.parent}},{key:"getWorldTransformMatrix",value:function(){var e=this.transform.getTransformationMatrix();if(null===this.parent)return e;var t=this.parent.getWorldTransformMatrix(),i=J.a.create();return J.a.multiply(i,t,e)}},{key:"setMesh",value:function(e){this.mesh=e}},{key:"getMesh",value:function(){return this.mesh}},{key:"setMaterial",value:function(e){this.material=e}},{key:"getMaterial",value:function(){return this.material}},{key:"setTransform",value:function(e){this.transform=e}},{key:"getTransform",value:function(){return this.transform}},{key:"renderObj",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=J.a.create();J.a.multiply(n,t,this.transform.getTransformationMatrix());var a=this.material;if(this.isSelected&&(a=Ze.getSelectedObjectMaterial()),this.mesh&&this.mesh.isEnabled()&&a){K.enablePolygonOffset(.1,1);var s=a.getFaceMaterial().getShader();if(this.setUpShader(s,e,n),a.getFaceMaterial().enableMaterial(),this.mesh.drawFaces(s),K.disablePolygonOffset(),i){var r=a.getEdgeMaterial().getShader();this.setUpShader(r,e,n),a.getEdgeMaterial().enableMaterial(),this.mesh.drawEdges(r)}}this.children.forEach((function(t){t.renderObj(e,n,i)}))}},{key:"setUpShader",value:function(e,t,i){e.use(),e.enableViewProjectionMatrices(t.getLookAtMatrix(),t.getProjectionMatrix()),e.enableTransformationMatrix(i)}}]),e}(),Qe=function(){function e(t,i,n){Object(q.a)(this,e),this.points=void 0,this.edges=void 0,this.faces=void 0,this.points=t,this.edges=i,this.faces=n}return Object(Z.a)(e,[{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}}]),e}(),$e=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe;Object(q.a)(this,e),this.enabled=void 0,this.faces=[],this.edges=[],this.points=[],this.verticesBuffer=null,this.indicesBuffer=null,this.vertices=[],this.indicesFaces=[],this.indicesEdges=[],this.indicesPoints=[],this.enabled=!0,this.points=t.getPoints(),this.edges=t.getEdges(),this.faces=t.getFaces(),this.verticesBuffer=K.createBuffer(),this.indicesBuffer=K.createBuffer(),this.generateWebglVertexes(),this.loadVerticesBuffer(),this.loadIndicesBuffer()}return Object(Z.a)(e,[{key:"loadVerticesBuffer",value:function(){this.verticesBuffer&&K.uploadDataToBuffer(this.verticesBuffer,this.vertices)}},{key:"loadIndicesBuffer",value:function(){this.indicesBuffer&&K.uploadElementDataToBuffer(this.indicesBuffer,this.indicesFaces)}},{key:"useFaces",value:function(e){this.verticesBuffer&&this.indicesBuffer&&(K.bindArrayBuffer(this.verticesBuffer),e.enablePosition(),K.bindElementArrayBuffer(this.indicesBuffer))}},{key:"getIndicesLength",value:function(){return this.indicesFaces?this.indicesFaces.length:0}},{key:"generateWebglVertexes",value:function(){var e=[],t=[],i=[],n=[];this.faces.forEach((function(e){var n=[],a=[];e.getEdges().forEach((function(e){var t=e.getPoints(),s=Object(o.a)(t,2),r=s[0],c=s[1],l=i.find((function(e){return e===r})),u=i.find((function(e){return e===c}));if(l||(i.push(r),l=r),u||(i.push(c),u=c),0===n.length)return n.push(l),a.push(i.indexOf(l)),n.push(u),void a.push(i.indexOf(u));l===n[0]&&u!==n[n.length-1]?(n.unshift(u),a.unshift(i.indexOf(u))):l===n[n.length-1]&&u!==n[0]?(n.push(u),a.push(i.indexOf(u))):u===n[0]&&l!==n[n.length-1]?(n.unshift(l),a.unshift(i.indexOf(l))):u===n[n.length-1]&&l!==n[0]&&(n.push(l),a.push(i.indexOf(l)))})),t=t.concat(a)})),this.edges.forEach((function(e){var t=e.getPoints(),a=Object(o.a)(t,2),s=a[0],r=a[1],c=i.find((function(e){return e===s})),l=i.find((function(e){return e===r}));c||(i.push(s),c=s),l||(i.push(r),l=r),n.push(i.indexOf(c)),n.push(i.indexOf(l))})),i.forEach((function(t){var i=t.getCords();e.push([i[0],i[1],i[2]])}));var a=e.flat();return this.vertices=a,this.indicesFaces=t,this.indicesEdges=n,this.indicesPoints=Array.from(Array(i.length).keys()),[a,t]}},{key:"copy",value:function(){var t=this,i=[],n=[],a=[];return this.points.forEach((function(e){var t=J.d.create();J.d.copy(t,e.getCords()),i.push(new Q(t))})),this.edges.forEach((function(e){var a=t.points.find((function(t){return t===e.getPoints[0]})),s=i.find((function(t){return t===e.getPoints[1]}));if(a&&s){var r=t.points.indexOf(a),o=t.points.indexOf(s);r>=0&&o>=0&&n.push(new $(i[r],i[o]))}})),this.faces.forEach((function(e){var i=[];e.getEdges().forEach((function(e){var n=t.edges.find((function(t){return t===e}));if(n){var a=t.edges.indexOf(n);a>=0&&i.push(a)}}));var s=i.map((function(e){return n[e]}));a.push(new ee([s[0],s[1],s[2]]))})),new e(new Qe(i,n,a))}},{key:"raycastMesh",value:function(e,t){var i=[],n=[],a=[];return this.enabled&&(e.getMode()&Ne.face&&this.faces.forEach((function(i){a.push(i.raycastFace(e,t))})),e.getMode()&Ne.edge&&this.edges.forEach((function(i){n.push(i.raycastEdge(e,t))})),e.getMode()&Ne.point&&this.points.forEach((function(n){i.push(n.raycastPoint(e,t))}))),{pointsHits:i.filter((function(e){return null!==e})),edgesHits:n.filter((function(e){return null!==e})),facesHits:a.filter((function(e){return null!==e}))}}},{key:"drawPoints",value:function(e){this.verticesBuffer&&(e.use(),K.bindArrayBuffer(this.verticesBuffer),e.enablePosition(),K.drawArraysPoint(this.points.length))}},{key:"drawEdges",value:function(e){this.verticesBuffer&&this.indicesBuffer&&(e.use(),K.bindArrayBuffer(this.verticesBuffer),e.enablePosition(),K.uploadElementDataToBuffer(this.indicesBuffer,this.indicesEdges),K.bindElementArrayBuffer(this.indicesBuffer),K.drawElementsEdge(this.indicesEdges.length))}},{key:"drawFaces",value:function(e){this.verticesBuffer&&this.indicesBuffer&&(e.use(),K.bindArrayBuffer(this.verticesBuffer),e.enablePosition(),K.uploadElementDataToBuffer(this.indicesBuffer,this.indicesFaces),K.bindElementArrayBuffer(this.indicesBuffer),K.drawElementsTriangle(this.indicesFaces.length))}},{key:"refreshBuffers",value:function(){this.generateWebglVertexes(),this.loadVerticesBuffer()}},{key:"getPoints",value:function(){return this.points}},{key:"getEdges",value:function(){return this.edges}},{key:"getFaces",value:function(){return this.faces}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!0}},{key:"enableDisable",value:function(e){this.enabled=e}},{key:"isEnabled",value:function(){return this.enabled}}]),e}(),et=Object(n.createContext)(null),tt=Object(n.createContext)(null),it=i(20),nt=i(450),at=i(141),st=i.n(at);function rt(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=[];i&&(a=i);var s=ot(e,t,a),r=[];return n&&(r=e.getChildrenList().map((function(e){var i=J.a.create();return J.a.mul(i,t,e.getTransform().getTransformationMatrix()),rt(e,i,a,n)}))),[s].concat(r).join("\n")}function ot(e,t,i){var n=e.getMesh(),a=!1;if(!n)return"";var s=n.getPoints();i.push.apply(i,Object(it.a)(s));var r=s.map((function(e){var i=J.d.create();return J.d.transformMat4(i,e.getCords(),t),"v "+i.join(" ")})),o=n.getFaces().map((function(e){return a?"":"f "+e.getPoints().map((function(e){var t=i.indexOf(e);return t<0?(a=!0,0):t+1})).join(" ")}));return a?"":["o ".concat(e.getName())].concat(r,o).join("\n")}var ct=function(){var e=Object(n.useContext)(H),t=(Object(n.useContext)(tt),Object(n.useState)(!1)),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(null),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(!0),d=Object(o.a)(h,2),g=d[0],v=d[1];Object(n.useEffect)((function(){(null===e||void 0===e?void 0:e.isOpen)&&a&&b()}),[l,null===e||void 0===e?void 0:e.isOpen,a]),Object(n.useEffect)((function(){a&&s(!!e&&e.isOpen)}),[null===e||void 0===e?void 0:e.isOpen]);var b=function(){null===e||void 0===e||e.setModalData({header:"Import object",body:Object(f.jsxs)(U.a,{children:[Object(f.jsx)(y.a,{type:"file",name:"file",accept:".obj",onChange:function(e){u(e.target.files&&e.target.files.length>0?e.target.files[0]:null),v(!(e.target.files&&e.target.files.length>0))},invalid:g}),Object(f.jsx)(X.a,{className:"input-error",children:"File is not chosen"})]}),onOk:function(){if(console.log(l),!l)return!1;var e=new FileReader;return e.onload=function(e){if(e&&e.target&&e.target.result){var t,i=l.name,n=function(e){for(var t=e.split(/\r\n|\n/),i=[],n=[],a=[],s=[],r=[],o=[],c=[],l=[],u=null,h=!1,d=0;d<t.length;d++){var f=t[d].trim().split(/\s+/);if("o"===f[0]&&(h||u&&(u.setMesh(new $e(new Qe(n,s,o))),l.push(u)),n=[],s=[],o=[],h=!1,u=new Ke,f[1]&&u.setName(f[1])),(4===f.length||5===f.length)&&"v"===f[0]&&!h){var g=1;if(5===f.length&&(g=parseFloat(f[4])),Object(nt.a)(g)||0===g){h=!0;break}var v=parseFloat(f[1])/g,b=parseFloat(f[2])/g,j=parseFloat(f[3])/g;if(Object(nt.a)(v)||Object(nt.a)(b)||Object(nt.a)(j)){h=!0;break}var m=new Q([v,b,j]);i.push(m),n.push(m)}if("f"===f[0]&&!h){var O=f.slice(1).map((function(e){return parseInt(e.split("/")[0])})),p=[];3===O.length?p=[O]:function(){var e=O.map((function(e){return i[e-1]}));if(e.length>3){var t=e.map((function(e){var t=e.getCords();return[t[0],t[1]]})),n=t[0],a=t[1],s=t.map((function(e,t){return t<2||(i=n[0],s=n[1],r=a[0],o=a[1],c=e[0],0===i*(o-(l=e[1]))+r*(l-s)+c*(s-o));var i,s,r,o,c,l})).reduce((function(e,t){return e&&t}),!0),r=[];if(s)for(var o=function(t){var i=e.map((function(e){var i=e.getCords();return[i[0+t],i[2]]}));if((r=st()(i.flat(),[],2)).length>0)return"break"},c=0;c<2&&"break"!==o(c);c++);else r=st()(e.map((function(e){return e.getCords()})).flat(),[],3);for(var l=r.map((function(t){return i.indexOf(e[t])+1})),u=[];l.length;)u.push(l.splice(0,3));p=u}}(),p.forEach((function(e){for(var t=[],n=function(n){var r=e[n],o=e[(n+1)%e.length];if(r<1||o<1)return{v:null};var l=e.find((function(e){return e[0]===r&&e[1]===o||e[0]===o&&e[1]===r}));if(l)t.push(a[l[2]]);else{var u=new $(i[r-1],i[o-1]);c.push([r,o,a.length]),a.push(u),s.push(u),t.push(u)}},l=0;l<e.length;l++){var u=n(l);if("object"===typeof u)return u.v}var h=new ee(t);r.push(h),o.push(h)}))}}return h||u&&(u.setMesh(new $e(new Qe(n,s,o))),l.push(u)),l}(e.target.result);if(0===n.length)return;var a=new Ke,s=i.split(".")[0];a.setName(s);var r=ze.getSelectedObject();r||(r=ze.getWorld()),null===(t=r)||void 0===t||t.addChild(a),a.setParent(r),n.forEach((function(e){e.setParent(a),a.addChild(e)})),Ee.refresh()}},e.readAsText(l),!0}})};return Object(f.jsx)(P,{text:"Import OBJ file",ico:Object(f.jsx)(D.b,{}),onClick:function(){u(null),v(!0),null===e||void 0===e||e.open(),s(!0)}})};var lt=function(e){return Object(f.jsx)(h.a,{onClick:function(){var t=ze.getSelectedObject();t||(t=ze.getWorld()),t&&function(e,t){var i=new Blob([t],{type:"text/csv"}),n=window.navigator;if(n.msSaveOrOpenBlob)n.msSaveBlob(i,e);else{var a=window.document.createElement("a");a.href=window.URL.createObjectURL(i),a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}("".concat(t.getName(),".obj"),function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[],n=J.a.create();return J.a.identity(n),rt(e,n,i,t)}(t,e.exportChildren))},children:"Export to OBJ"})},ut=function(e){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(lt,{exportChildren:e.exportChildren})})},ht=function(e){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(h.a,{header:!0,children:"Settings"}),Object(f.jsxs)(h.a,{toggle:!1,onClick:function(){e.changeExportChildren(!e.exportChildren)},children:[Object(f.jsx)(_.a,{children:"Save children \xa0"}),Object(f.jsx)(y.a,{type:"checkbox",checked:e.exportChildren})]}),Object(f.jsx)(h.a,{header:!0,children:"Actions"}),Object(f.jsx)(ut,{exportChildren:e.exportChildren})]})},dt=i(455),ft=function(){var e=Object(n.useContext)(H);return Object(f.jsx)(h.a,{onClick:function(){null===e||void 0===e||e.setModalData({header:"Instruction",body:Object(f.jsx)(gt,{})}),null===e||void 0===e||e.open()},children:"Instruction"})},gt=function(){return Object(f.jsxs)(Y.a,{children:[Object(f.jsx)("h3",{children:"Camera"}),Object(f.jsxs)(dt.a,{children:[Object(f.jsx)("p",{children:"When you hold down C key, the camera is in Orbiting mode, where you can change viewing angles by moving around mouse while holding left mouse button."}),Object(f.jsx)("p",{children:"When you hold down Shift key, the camera is in Flying mode, where you can move the camera position by holding down W, A, S, D keys."}),Object(f.jsx)("p",{children:"When holding C key or Shift key you can zoom in or zoom out by using mouse scroll"})]}),Object(f.jsx)("h3",{children:"Views"}),Object(f.jsxs)("p",{children:["There is a predefined set of tools for each view. There are currently 2 views in the application:",Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Layout view"}),Object(f.jsx)("li",{children:"Edit view"})]})]}),Object(f.jsx)("h5",{children:"Layout view"}),Object(f.jsx)("p",{children:"In layout view, you can manipulate position of an object in space in relation to other objects. In this view you can also select an object, that can be used in other views. Objects are selected with the left mouse button."}),Object(f.jsx)("h5",{children:"Edit view"}),Object(f.jsx)("p",{children:"In edit view, you can manipulate positions and other properties of the vertices, edges and faces of the selected object. To switch between editing modes, use the menu in upper left corner of the viewport."}),Object(f.jsx)("h3",{children:"Tools"}),Object(f.jsx)("p",{children:"There is a toolbox in the upper left section of the browser. In toolbox, you can change selected tool, that can be used to manipulate objects. Selected tool is highlighted."}),Object(f.jsx)("h3",{children:"Tool properties"}),Object(f.jsx)("p",{children:"There is a tool's properties window in the bottom left section of the browser. In this window you can manipulate tool's properties, for example, speed change factor. Some properties are global and other are common to given set of tools."}),Object(f.jsx)("h3",{children:"Navigation tree"}),Object(f.jsx)("p",{children:"There is a navigation tree window in the upper right section of the browser. In this window you can manipulate object in render queue hierarchy by dragging objects over another object. In this window you can an select object or you can delete an object. Position of object in space is computed relative to its parent. For this reason, when you change the tree hierarchy some objects may change their position in space."}),Object(f.jsx)("h3",{children:"Object properties"}),Object(f.jsx)("p",{children:"There is an object properties window in the bottom right section of the browser. In this window, you can manipulate object properties such as position. Note that presented in this window position, orientation and scale are relative to its parent."}),Object(f.jsx)("h3",{children:"Adding new objects"}),Object(f.jsxs)("p",{children:["To add new object to the scene, you need to open",Object(f.jsx)("q",{children:"Menu"})," drop-down and select ",Object(f.jsx)("q",{children:"Add Object"}),". There you can select the type of mesh and set its properties such as height. To confirm the new object, press ",Object(f.jsx)("q",{children:"Ok"})," button. The new object will be added as a child of selected object or as a child of root element if no object is selected."]}),Object(f.jsx)("h3",{children:"Importing existing object"}),Object(f.jsxs)("p",{children:["To import an object from a file, click the ",Object(f.jsx)("q",{children:"Import"})," button. In the window that appears, select the object to be imported, and then confirm. The imported object will be added as a child of selected object or as a child of root element if no object is selected."]}),Object(f.jsx)("h3",{children:"Exporting object"}),"To export an object to a file, open the ",Object(f.jsx)("q",{children:"Export"}),"drop-down menu and select file extension. In the menu that opens, there is an option to change the behavior of the export mechanism. You can either export one object or export an entire subtree of objects into. The selected object will be exported or root element if no object is selected."]})},vt=function(){var e=Object(n.useContext)(b),t=Object(n.useContext)(H),i=Object(n.useContext)(tt),a=Object(n.useRef)(!1),s=Object(n.useRef)(void 0),r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1];return Object(f.jsxs)(g,{backgroundColor:null===e||void 0===e?void 0:e.colorMode.backgroundColor,borderColor:null===e||void 0===e?void 0:e.colorMode.accentColor,borderWidth:2,children:[Object(f.jsxs)(T,{text:"Menu",ico:Object(f.jsx)(D.c,{}),children:[Object(f.jsx)(h.a,{onClick:function(){null===t||void 0===t||t.setModalData({header:"Add Object",body:Object(f.jsx)(ye,{markError:function(e){return a.current=e},currentBuilderRef:s}),onOk:function(){if(!a.current&&void 0!==s.current){var e=null,t=ze.getSelectedObject(),n=ze.getWorld(),r=new Ke;s.current&&r.setMesh(new $e(s.current.build())),t?e=t:n&&(e=n),e&&(e.addChild(r),r.setParent(e),null===i||void 0===i||i.refresh())}return!a.current}}),null===t||void 0===t||t.open()},children:"Add Object"}),Object(f.jsx)(ft,{})]}),Object(f.jsx)(ct,{}),Object(f.jsx)(T,{text:"Export",ico:Object(f.jsx)(D.a,{}),children:Object(f.jsx)(ht,{exportChildren:l,changeExportChildren:u})})]})},bt=i(444),jt=i(57),mt=Object(n.createContext)(null),Ot=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:60;Object(q.a)(this,e),this.azAngle=void 0,this.elAngle=void 0,this.distanceToLookingPoint=void 0,this.position=void 0,this.pointToLook=void 0,this.lookAtMatrix=void 0,this.invertedLookAtMatrix=void 0,this.projectionMatrix=void 0,this.fov=void 0,this.isCameraUpSideDown=!1,this.screenWidth=0,this.screenHeight=0,this.canvasEvent=null,this.azAngle=t,this.elAngle=i,this.distanceToLookingPoint=n,this.pointToLook=a,this.position=this.updatePosition(),this.invertedLookAtMatrix=J.a.create(),this.lookAtMatrix=this.calcLookAt(),this.fov=s,this.projectionMatrix=J.a.create();var r=K.returnCanvas();if(r){this.screenHeight=r.height,this.screenWidth=r.width;var o=r.width/r.height;this.projectionMatrix||(this.projectionMatrix=J.a.create()),J.a.perspective(this.projectionMatrix,Ie(this.fov/o),o,.1,100)}}return Object(Z.a)(e,[{key:"onResize",value:function(e,t,i,n){this.screenHeight=n,this.screenWidth=i;var a=i/n;this.projectionMatrix||(this.projectionMatrix=J.a.create()),J.a.perspective(this.projectionMatrix,Ie(this.fov/a),a,.1,1e5)}},{key:"updatePosition",value:function(){return this.position=[this.distanceToLookingPoint*Math.cos(this.azAngle)*Math.cos(this.elAngle),this.distanceToLookingPoint*Math.sin(this.elAngle),this.distanceToLookingPoint*Math.sin(this.azAngle)*Math.cos(this.elAngle)],J.d.add(this.position,this.position,this.pointToLook),this.position}},{key:"getScreenDimensions",value:function(){return[this.screenWidth,this.screenHeight]}},{key:"calcLookAt",value:function(){var e=[0,1,0];return this.isCameraUpSideDown=!1,(this.elAngle>Math.PI/2||this.elAngle<=-Math.PI/2)&&(e[1]=-1,this.isCameraUpSideDown=!0),this.lookAtMatrix=J.a.create(),this.lookAtMatrix=J.a.lookAt(this.lookAtMatrix,this.position,this.pointToLook,e),J.a.invert(this.invertedLookAtMatrix,this.lookAtMatrix),this.lookAtMatrix}},{key:"getLookAtMatrix",value:function(){var e=J.a.create();return J.a.copy(e,this.lookAtMatrix),e}},{key:"getCameraToWorldMatrix",value:function(){var e=J.a.create();return J.a.copy(e,this.invertedLookAtMatrix),e}},{key:"getProjectionMatrix",value:function(){var e=J.a.create();return J.a.copy(e,this.projectionMatrix),e}},{key:"checkIfCameraUpSideDown",value:function(){return this.isCameraUpSideDown}},{key:"getRadius",value:function(){return this.distanceToLookingPoint}},{key:"setRadius",value:function(e){this.distanceToLookingPoint=e,this.updatePosition(),this.calcLookAt()}},{key:"getAzimutAngle",value:function(){return this.azAngle}},{key:"setAzimutAngle",value:function(e){this.azAngle=Be(e),this.updatePosition(),this.calcLookAt()}},{key:"getElevationAngle",value:function(){return this.elAngle}},{key:"setElevationAngle",value:function(e){this.elAngle=Be(e),this.updatePosition(),this.calcLookAt()}},{key:"getPosition",value:function(){var e=J.d.create();return J.d.copy(e,this.position),e}},{key:"setPointToLookAt",value:function(e){J.d.copy(this.pointToLook,e),this.updatePosition(),this.calcLookAt()}},{key:"getPointToLookAt",value:function(){var e=J.d.create();return J.d.copy(e,this.pointToLook),e}},{key:"setCanvasEvent",value:function(e){this.canvasEvent&&this.canvasEvent.unsubscribe(this),this.canvasEvent=e,this.canvasEvent&&this.canvasEvent.subscribe(this)}},{key:"getUnProjectMatrix",value:function(){var e=J.a.create(),t=J.a.create();return J.a.copy(e,J.a.invert(e,this.getProjectionMatrix())),J.a.multiply(e,J.a.invert(t,this.getLookAtMatrix()),e),e}}]),e}(),pt=new(function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.apply(this,arguments)}return Object(Z.a)(i,[{key:"init",value:function(){var e=this;document.onkeydown=function(t){e.getListeners().forEach((function(e){e.onKeyDown(t)})),e.refresh()},document.onkeyup=function(t){e.getListeners().forEach((function(e){e.onKeyUp(t)})),e.refresh()}}}]),i}(Te)),yt=new(function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){var e;Object(q.a)(this,i);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).x=0,e.y=0,e.isPressed=!1,e}return Object(Z.a)(i,[{key:"init",value:function(){var e=this,t=K.returnWebGLContext();if(t){var i=t.canvas;i.onwheel=function(t){e.getListeners().forEach((function(e){e.onWheel(t)})),e.refresh()},i.onmousemove=function(t){var i=t.clientX-e.x,n=t.clientY-e.y;e.x=t.clientX,e.y=t.clientY,e.getListeners().forEach((function(e){e.onMouseMove(t,i,n)})),e.refresh()},i.onmousedown=function(t){e.x=t.clientX,e.y=t.clientY,e.isPressed=!0,e.getListeners().forEach((function(e){e.onMouseDown(t)})),e.refresh()},i.onmouseup=function(t){e.isPressed=!1,e.getListeners().forEach((function(e){e.onMouseUp(t)})),e.refresh()},i.onclick=function(t){e.getListeners().forEach((function(e){e.onMouseClick(t)})),e.refresh()}}}}]),i}(Te)),xt=function(){function e(t,i){Object(q.a)(this,e),this.camera=void 0,this.raycaster=void 0,this.isActive=!1,this.blockedBy=0,this.isInFlyingMode=!1,this.isInOrbitMode=!1,this.zoomScale=.01,this.pix2angle=.2,this.angleSpeed=.02,this.cameraMotionSpeed=.1,this.isLeftActive=!1,this.isRightActive=!1,this.isMiddleActive=!1,this.cameraCanvasWidth=void 0,this.keysPressed={},this.signAzimut=-1,this.signElevation=-1,this.camera=t,this.raycaster=i,pt.subscribe(this),yt.subscribe(this),this.cameraCanvasWidth=this.camera.getScreenDimensions()[0],this.pix2angle=180/this.cameraCanvasWidth}return Object(Z.a)(e,[{key:"isCameraActive",value:function(){return this.isActive}},{key:"isCameraBlocked",value:function(){return 0!==this.blockedBy}},{key:"block",value:function(){this.blockedBy++}},{key:"unblock",value:function(){this.blockedBy>0&&this.blockedBy--}},{key:"onKeyDown",value:function(e){this.blockedBy||("c"!==e.key&&"C"!==e.key||(this.isActive=!0,this.isInOrbitMode=!0,this.keysPressed.c=!0),e.shiftKey&&(this.isInFlyingMode=!0,this.isActive=!0,this.keysPressed.shift=!0),"a"!==e.key&&"A"!==e.key||(this.keysPressed.a=!0),"s"!==e.key&&"S"!==e.key||(this.keysPressed.s=!0),"d"!==e.key&&"D"!==e.key||(this.keysPressed.d=!0),"w"!==e.key&&"W"!==e.key||(this.keysPressed.w=!0),this.updatePosInFlyingMode())}},{key:"onKeyUp",value:function(e){this.blockedBy||("c"!==e.key&&"C"!==e.key||(this.isInOrbitMode=!1,this.keysPressed.c=!1),e.shiftKey||(this.isInFlyingMode=!1,this.keysPressed.shift=!1),"a"!==e.key&&"A"!==e.key||(this.keysPressed.a=!1),"s"!==e.key&&"S"!==e.key||(this.keysPressed.s=!1),"d"!==e.key&&"D"!==e.key||(this.keysPressed.d=!1),"w"!==e.key&&"W"!==e.key||(this.keysPressed.w=!1),this.keysPressed.c||this.keysPressed.shift||(this.isActive=!1))}},{key:"onWheel",value:function(e){if(!this.blockedBy&&this.isActive){var t=this.camera.getRadius()+e.deltaY*this.zoomScale;t>.1&&this.camera.setRadius(t)}}},{key:"onMouseMove",value:function(e,t,i){var n=this.camera.getScreenDimensions()[0];n!==this.cameraCanvasWidth&&(this.pix2angle=180/n,this.cameraCanvasWidth=n),this.blockedBy||this.isActive&&(this.isInOrbitMode&&this.isLeftActive?(this.camera.setAzimutAngle(this.camera.getAzimutAngle()+this.signAzimut*this.pix2angle*this.angleSpeed*-t),this.camera.setElevationAngle(this.camera.getElevationAngle()+this.signElevation*this.pix2angle*this.angleSpeed*-i)):this.isInFlyingMode&&this.isLeftActive)}},{key:"onMouseDown",value:function(e){this.blockedBy||(0===e.button&&(this.isLeftActive=!0),1===e.button&&(this.isMiddleActive=!0),2===e.button&&(this.isRightActive=!0),this.signAzimut=this.camera.checkIfCameraUpSideDown()?1:-1)}},{key:"onMouseUp",value:function(e){this.blockedBy||(0===e.button&&(this.isLeftActive=!1),1===e.button&&(this.isMiddleActive=!1),2===e.button&&(this.isRightActive=!1))}},{key:"onMouseClick",value:function(e){}},{key:"cleanUp",value:function(){yt.unsubscribe(this),pt.unsubscribe(this)}},{key:"updatePosInFlyingMode",value:function(){if(this.isActive&&this.isInFlyingMode){var e=J.d.create();if(J.d.zero(e),this.keysPressed.d&&J.d.add(e,e,[1,0,0]),this.keysPressed.a&&J.d.add(e,e,[-1,0,0]),this.keysPressed.s&&J.d.add(e,e,[0,0,1]),this.keysPressed.w&&J.d.add(e,e,[0,0,-1]),!(J.d.length(e)<=0)){J.d.normalize(e,e);var t=J.e.fromValues(e[0],e[1],e[2],0),i=J.e.create();J.e.transformMat4(i,t,this.camera.getCameraToWorldMatrix());var n=i[3]?i[3]:1,a=J.d.fromValues(i[0]/n,i[1]/n,i[2]/n);J.d.normalize(a,a),J.d.scale(a,a,this.cameraMotionSpeed);var s=J.d.create();J.d.add(s,this.camera.getPointToLookAt(),a),this.camera.setPointToLookAt(s)}}}}]),e}();function kt(e){var t=null;return e.facesHits.forEach((function(e){t?e.distance<t.distance&&(t=e):t=e})),t}function wt(e){if(!e)return[null,null];var t=null,i=null;return e.forEach((function(e){if(t){var n=kt(e.hits);n&&i&&n.distance<i.distance&&(t=e,i=n)}else{var a=kt(e.hits);a&&(t=e,i=a)}})),[t,i]}function St(e,t,i,n,a,s){var r=new ae,o=(new le).setHeight(e).setRadiusBottom(t).setRadiusTop(t).setRadialSegments(a).build(),c=r.setRadius(n).setHeight(i).setRadialSegments(a).build(),l=new Ke,u=new Ke,h=new Ve;l.setMesh(new $e(o)),l.setMaterial(new Ye(new qe(new Xe,s))),h.setPositionInParent([0,e/2,0]),l.setTransform(h);var d=new Ve;u.setMesh(new $e(c)),u.setMaterial(new Ye(new qe(new Xe,s))),d.setPositionInParent([0,e+i/2,0]),u.setTransform(d);var f=new Ke;return f.addChild(l),f.addChild(u),f}function Mt(e,t,i,n,a){var s=(new he).setRadius(e).setTube(t).setRadialSegments(n).setTubularSegments(i).build(),r=new Ke,o=new Ve;r.setMesh(new $e(s)),r.setMaterial(new Ye(new qe(new Xe,a))),r.setTransform(o);var c=new Ke;return c.addChild(r),c}function Ct(e,t,i,n,a){var s=new re,r=(new le).setHeight(e).setRadiusBottom(t).setRadiusTop(t).setRadialSegments(n).build(),o=s.setXHalfWidth(1).setYHalfWidth(1).setZHalfWidth(1).build(),c=new Ke,l=new Ke,u=new Ve;c.setMesh(new $e(r)),c.setMaterial(new Ye(new qe(new Xe,a))),u.setPositionInParent([0,e/2,0]),c.setTransform(u);var h=new Ve;l.setMesh(new $e(o)),l.setMaterial(new Ye(new qe(new Xe,a))),h.setPositionInParent([0,e+1*i,0]),h.setScaleInParent([i,i,i]),l.setTransform(h);var d=new Ke;return d.addChild(c),d.addChild(l),d}var Pt,Tt=function(){function e(){Object(q.a)(this,e),this.gizmoX=void 0,this.gizmoY=void 0,this.gizmoZ=void 0,this.main=void 0,this.main=new Ke,this.gizmoX=St(2.5,.25,1.25,.5,12,[1,0,0,1]),this.gizmoY=St(2.5,.25,1.25,.5,12,[0,1,0,1]),this.gizmoZ=St(2.5,.25,1.25,.5,12,[0,0,1,1]);var t=new Ve;t.setOrientationInParent([0,0,Ie(-90)]),this.gizmoX.setTransform(t),this.main.addChild(this.gizmoX),(t=new Ve).setOrientationInParent([0,Ie(90),0]),this.gizmoY.setTransform(t),this.main.addChild(this.gizmoY),(t=new Ve).setOrientationInParent([Ie(90),0,0]),this.gizmoZ.setTransform(t),this.main.addChild(this.gizmoZ)}return Object(Z.a)(e,[{key:"getGizmo",value:function(){return this.main}},{key:"getGizmoX",value:function(){return this.gizmoX}},{key:"getGizmoY",value:function(){return this.gizmoY}},{key:"getGizmoZ",value:function(){return this.gizmoZ}}]),e}(),Et=function(){function e(){Object(q.a)(this,e),this.gizmoX=void 0,this.gizmoY=void 0,this.gizmoZ=void 0,this.main=void 0,this.main=new Ke,this.gizmoX=Mt(5,.25,26,5,[1,0,0,1]),this.gizmoY=Mt(5,.25,26,5,[0,1,0,1]),this.gizmoZ=Mt(5,.25,26,5,[0,0,1,1]);var t=new Ve;t.setOrientationInParent([0,Ie(-90),0]),this.gizmoX.setTransform(t),this.main.addChild(this.gizmoX),(t=new Ve).setOrientationInParent([Ie(90),0,0]),this.gizmoY.setTransform(t),this.main.addChild(this.gizmoY),(t=new Ve).setOrientationInParent([0,0,Ie(90)]),this.gizmoZ.setTransform(t),this.main.addChild(this.gizmoZ)}return Object(Z.a)(e,[{key:"getGizmo",value:function(){return this.main}},{key:"getGizmoX",value:function(){return this.gizmoX}},{key:"getGizmoY",value:function(){return this.gizmoY}},{key:"getGizmoZ",value:function(){return this.gizmoZ}}]),e}(),zt=function(){function e(){Object(q.a)(this,e),this.gizmoX=void 0,this.gizmoY=void 0,this.gizmoZ=void 0,this.main=void 0,this.main=new Ke,this.gizmoX=Ct(2.5,.25,.5,12,[1,0,0,1]),this.gizmoY=Ct(2.5,.25,.5,12,[0,1,0,1]),this.gizmoZ=Ct(2.5,.25,.5,12,[0,0,1,1]);var t=new Ve;t.setOrientationInParent([0,0,Ie(-90)]),this.gizmoX.setTransform(t),this.main.addChild(this.gizmoX),(t=new Ve).setOrientationInParent([0,Ie(90),0]),this.gizmoY.setTransform(t),this.main.addChild(this.gizmoY),(t=new Ve).setOrientationInParent([Ie(90),0,0]),this.gizmoZ.setTransform(t),this.main.addChild(this.gizmoZ)}return Object(Z.a)(e,[{key:"getGizmo",value:function(){return this.main}},{key:"getGizmoX",value:function(){return this.gizmoX}},{key:"getGizmoY",value:function(){return this.gizmoY}},{key:"getGizmoZ",value:function(){return this.gizmoZ}}]),e}(),It=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.apply(this,arguments)}return Object(Z.a)(i,[{key:"onMove",value:function(e,t,i){this.getListeners().forEach((function(n){n.onMove(e,t,i)}))}},{key:"onRotate",value:function(e,t,i){this.getListeners().forEach((function(n){n.onRotate(e,t,i)}))}},{key:"onScale",value:function(e,t,i){this.getListeners().forEach((function(n){n.onScale(e,t,i)}))}},{key:"onStart",value:function(){this.getListeners().forEach((function(e){e.onStart()}))}},{key:"onFinish",value:function(){this.getListeners().forEach((function(e){e.onFinish()}))}}]),i}(Te);!function(e){e[e.move=0]="move",e[e.rotate=1]="rotate",e[e.scale=2]="scale",e[e.gizmoUnused=3]="gizmoUnused"}(Pt||(Pt={}));var Rt=function(){function e(t,i){Object(q.a)(this,e),this.moveGizmo=void 0,this.rotateGizmo=void 0,this.scaleGizmo=void 0,this.camera=void 0,this.cameraController=void 0,this.isActive=!1,this.mode=void 0,this.activeSubGizmo="none",this.gizmoEvent=new It,this.point=void 0,this.distPointCam=0,this.raycaster=void 0,this.moveGizmo=new Tt,this.rotateGizmo=new Et,this.scaleGizmo=new zt,this.camera=t,this.cameraController=i,this.point=J.d.fromValues(0,0,0),this.mode=Pt.move,this.raycaster=new Ge(new We,this.moveGizmo.getGizmo(),Ne.face,!0),yt.subscribe(this)}return Object(Z.a)(e,[{key:"activate",value:function(){this.isActive=!0}},{key:"subscribeToGizmo",value:function(e){this.gizmoEvent.subscribe(e)}},{key:"unsubscribeToGizmo",value:function(e){this.gizmoEvent.unsubscribe(e)}},{key:"inactivate",value:function(){this.isActive=!1}},{key:"setPoint",value:function(e){this.point=e}},{key:"setMode",value:function(e){this.mode=e}},{key:"getMode",value:function(){return this.mode}},{key:"render",value:function(){if(this.isActive&&this.mode!==Pt.gizmoUnused){K.clearDepthBuffer();var e=new Ke;switch(this.mode){case Pt.move:e=this.moveGizmo.getGizmo();break;case Pt.rotate:e=this.rotateGizmo.getGizmo();break;case Pt.scale:e=this.scaleGizmo.getGizmo()}var t=J.a.create();J.a.fromTranslation(t,this.point);var i=J.d.create();J.d.sub(i,this.camera.getPosition(),this.point),this.distPointCam=J.d.len(i);var n=.025*this.distPointCam;e.getTransform().setScaleInParent([n,n,n]),e.renderObj(this.camera,t,!1)}}},{key:"raycastGizmo",value:function(e){var t,i;if(!this.isActive||this.mode===Pt.gizmoUnused)return!1;this.raycaster.setRay(e);var n=this.moveGizmo.getGizmoX(),a=this.moveGizmo.getGizmoY(),s=(this.moveGizmo.getGizmoZ(),new Ke);switch(s.getTransform().setPositionInParent(this.point),this.mode){case Pt.move:s.addChild(this.moveGizmo.getGizmo()),n=this.moveGizmo.getGizmoX(),a=this.moveGizmo.getGizmoY(),this.moveGizmo.getGizmoZ();break;case Pt.rotate:s.addChild(this.rotateGizmo.getGizmo()),n=this.rotateGizmo.getGizmoX(),a=this.rotateGizmo.getGizmoY(),this.rotateGizmo.getGizmoZ();break;case Pt.scale:s.addChild(this.scaleGizmo.getGizmo()),n=this.scaleGizmo.getGizmoX(),a=this.scaleGizmo.getGizmoY(),this.scaleGizmo.getGizmoZ()}var r=new Ke;r.addChild(s),this.raycaster.setRaycastable(r);var o=wt(this.raycaster.cast());if(!(null===(t=o[0])||void 0===t?void 0:t.hittedObject))return!1;var c=null===(i=o[0])||void 0===i?void 0:i.hittedObject;return c&&(c=c.getParent()),console.log(n,c),this.activeSubGizmo=n===c?"x":a===c?"y":"z",this.cameraController.block(),this.gizmoEvent.onStart(),!0}},{key:"handleCastMoveGizmo",value:function(e,t){var i=e,n=-t,a=J.d.fromValues(0,0,0);"x"===this.activeSubGizmo?a[0]=1:"y"===this.activeSubGizmo?a[1]=1:"z"===this.activeSubGizmo&&(a[2]=1);var s=i;Math.abs(n)>Math.abs(i)&&(s=n),J.d.scale(a,a,.001*this.distPointCam*s),this.gizmoEvent.onMove(a[0],a[1],a[2])}},{key:"handleCastRotateGizmo",value:function(e,t){var i=e,n=-t,a=J.d.fromValues(0,0,0);"x"===this.activeSubGizmo?a[0]=1:"y"===this.activeSubGizmo?a[1]=1:"z"===this.activeSubGizmo&&(a[2]=1);var s=i;Math.abs(n)>Math.abs(i)&&(s=n),J.d.scale(a,a,.01*s),this.gizmoEvent.onRotate(a[0],a[1],a[2])}},{key:"handleCastScaleGizmo",value:function(e,t){var i=e,n=-t,a=J.d.fromValues(0,0,0);"x"===this.activeSubGizmo?a[0]=1:"y"===this.activeSubGizmo?a[1]=1:"z"===this.activeSubGizmo&&(a[2]=1);var s=J.e.fromValues(1,0,0,0),r=J.a.create();J.a.invert(r,this.camera.getLookAtMatrix());var o=s[3]?s[3]:1;J.e.transformMat4(s,s,r);var c=J.d.fromValues(s[0]/o,s[1]/o,s[2]/o);J.d.normalize(c,c);J.d.dot(a,c);var l=i;Math.abs(n)>Math.abs(i)&&(l=n),J.d.scale(a,a,.001*this.distPointCam*l),this.gizmoEvent.onScale(a[0],a[1],a[2])}},{key:"onWheel",value:function(e){}},{key:"onMouseMove",value:function(e,t,i){if("none"!==this.activeSubGizmo&&this.isActive)switch(this.mode){case Pt.move:this.handleCastMoveGizmo(t,i);break;case Pt.rotate:this.handleCastRotateGizmo(t,i);break;case Pt.scale:this.handleCastScaleGizmo(t,i)}}},{key:"onMouseDown",value:function(e){}},{key:"onMouseUp",value:function(e){this.activeSubGizmo="none",this.cameraController.unblock(),this.gizmoEvent.onFinish()}},{key:"onMouseClick",value:function(e){}},{key:"cleanUp",value:function(){yt.unsubscribe(this)}}]),e}();function At(e,t,i){e.use(),e.enableViewProjectionMatrices(t.getLookAtMatrix(),t.getProjectionMatrix()),e.enableTransformationMatrix(i)}var Ft=function(){function e(t,i){Object(q.a)(this,e),this.camera=void 0,this.objToRender=void 0,this.selectedPoint=null,this.selectedEdge=null,this.selectedFace=null,this.camera=t,this.objToRender=i}return Object(Z.a)(e,[{key:"selectPoint",value:function(e){this.selectedPoint=e}},{key:"unselectPoint",value:function(){this.selectedPoint=null}},{key:"selectEdge",value:function(e){this.selectedEdge=e}},{key:"unselectEdge",value:function(){this.selectedEdge=null}},{key:"selectFace",value:function(e){this.selectedFace=e}},{key:"unselectFace",value:function(){this.selectedFace=null}},{key:"renderFrame",value:function(){K.clear(0,0,0,.3),K.viewport(),K.enableDepthTest(!0),this.renderObject()}},{key:"renderObject",value:function(){var e=J.a.create();J.a.identity(e);var t=this.objToRender.getMesh();if(t){if(this.selectedPoint){var i=Ze.getSelectedPointMaterial();if(i){var n=i.getPointMaterial().getShader();At(n,this.camera,e),i.getPointMaterial().enableMaterial(),this.selectedPoint.drawPoint(n)}}if(this.selectedEdge){var a=Ze.getSelectedEdgeMaterial();if(a){var s=a.getEdgeMaterial().getShader();At(s,this.camera,e),a.getEdgeMaterial().enableMaterial(),this.selectedEdge.drawEdge(s)}}if(this.selectedFace){var r=Ze.getSelectedFaceMaterial();if(r){K.enablePolygonOffset(.1,1);var o=r.getFaceMaterial().getShader();At(o,this.camera,e),r.getFaceMaterial().enableMaterial(),this.selectedFace.drawFace(o),K.disablePolygonOffset()}}var c=Ze.getEditModeObjectMaterial();if(c||(c=this.objToRender.getMaterial()),c){K.enablePolygonOffset(.1,1);var l=c.getFaceMaterial().getShader();At(l,this.camera,e),c.getFaceMaterial().enableMaterial(),t.drawFaces(l),K.disablePolygonOffset();var u=c.getEdgeMaterial().getShader();At(u,this.camera,e),c.getEdgeMaterial().enableMaterial(),t.drawEdges(u);var h=c.getPointMaterial().getShader();At(h,this.camera,e),c.getPointMaterial().enableMaterial(),t.drawPoints(h)}}}}]),e}(),Bt=function(){function e(){Object(q.a)(this,e),yt.subscribe(this)}return Object(Z.a)(e,[{key:"onWheel",value:function(e){}},{key:"onMouseMove",value:function(e,t,i){}},{key:"onMouseDown",value:function(e){}},{key:"onMouseUp",value:function(e){}},{key:"onMouseClick",value:function(e){}},{key:"unsubscribe",value:function(){yt.unsubscribe(this)}}]),e}(),Lt=i(210),Nt=i(211),Vt=i(209),Gt=(i(288),function(e){var t=Object(n.useContext)(b);return Object(f.jsx)("div",{style:{display:"flex",backgroundColor:null===t||void 0===t?void 0:t.colorMode.secondaryColor,height:"40px",maxHeight:"40px",color:null===t||void 0===t?void 0:t.colorMode.accentColor,fontStyle:"italic",justifyContent:"center",alignItems:"center",fontSize:"1.2em",fontWeight:"bold"},className:e.className,children:e.title})}),Wt=function(e){var t=Object(n.useContext)(b);return Object(f.jsx)("div",{className:e.className,style:Object(d.a)({padding:"1rem",backgroundColor:null===t||void 0===t?void 0:t.colorMode.backgroundColor},e.style),children:e.children})},Dt=function(e){var t=Object(n.useContext)(b);return Object(f.jsxs)("fieldset",{style:Object(d.a)({borderColor:null===t||void 0===t?void 0:t.colorMode.accentColor,borderWidth:"2px",borderStyle:"solid",borderRadius:"0.5rem"},e.style),className:"card-body-frame ".concat(e.className?e.className:""),children:[e.title&&Object(f.jsx)("legend",{className:"card-body-frame",style:{color:null===t||void 0===t?void 0:t.colorMode.accentColor},children:e.title}),e.children]})},Ht=function(e){var t=Object(n.useContext)(b);return Object(f.jsx)("div",{className:"card-body-label ".concat(e.className?e.className:""),style:Object(d.a)({backgroundColor:null===t||void 0===t?void 0:t.colorMode.accentColor,color:null===t||void 0===t?void 0:t.colorMode.secondaryColor},e.style),children:e.children})},Ut=function(e){var t=Object(n.useContext)(b);return Object(f.jsxs)("div",{style:Object(d.a)({display:"flex",flexWrap:"wrap",paddingTop:"0.5em",paddingBottom:"0.5em"},e.style),className:e.className,children:[Object(f.jsx)("span",{style:{display:"inline-flex",alignItems:"center",color:null===t||void 0===t?void 0:t.colorMode.primaryColor,paddingRight:"1em"},children:e.label?"".concat(e.label,": "):" "}),Object(f.jsx)("div",{style:{display:"flex",flexGrow:1},children:e.children})]})},_t=function(){function e(){Object(q.a)(this,e)}return Object(Z.a)(e,[{key:"drawPropertiesCard",value:function(){return Object(f.jsx)(f.Fragment,{})}}]),e}(),Xt=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){var e;return Object(q.a)(this,i),(e=t.call(this)).startingVal=.1,e.minVal=.01,e.maxVal=10,e.clickRaycastArea=void 0,e.clickRaycastArea=e.startingVal,e}return Object(Z.a)(i,[{key:"getClickRaycastArea",value:function(){return this.clickRaycastArea}},{key:"drawPropertiesCard",value:function(){var e=this,t=function(){var t=Object(n.useState)(e.clickRaycastArea),i=Object(o.a)(t,2),a=i[0],s=i[1];return Object(f.jsx)(Dt,{title:"Mouse properties",children:Object(f.jsx)(Ut,{label:"mouseRange",children:Object(f.jsx)(N,{value:a,min:e.minVal,max:e.maxVal,step:e.minVal,onChange:function(t,i){s(i),e.clickRaycastArea=i},marks:[{value:e.minVal,label:e.minVal},{value:e.maxVal,label:e.maxVal}]})})})};return Object(f.jsx)(t,{})}}]),i}(_t),Yt=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Transforms Properties",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"change factor";return Object(q.a)(this,i),(e=t.call(this)).mouseProperties=Kt,e.startingVal=1,e.minVal=.01,e.maxVal=10,e.speedFactor=void 0,e.cardLabel=void 0,e.speedFactorLabel=void 0,e.speedFactor=e.startingVal,e.cardLabel=n,e.speedFactorLabel=a,e}return Object(Z.a)(i,[{key:"getMouseProperties",value:function(){return this.mouseProperties}},{key:"drawPropertiesCard",value:function(){var e=this,t=function(){var t=Object(n.useState)(e.speedFactor),i=Object(o.a)(t,2),a=i[0],s=i[1];return Object(f.jsxs)(f.Fragment,{children:[e.mouseProperties.drawPropertiesCard(),Object(f.jsx)(Dt,{title:e.cardLabel,children:Object(f.jsx)(Ut,{label:e.speedFactorLabel,children:Object(f.jsx)(N,{value:a,min:e.minVal,max:e.maxVal,step:e.minVal,onChange:function(t,i){s(i),e.speedFactor=i},marks:[{value:e.minVal,label:e.minVal},{value:e.maxVal,label:e.maxVal}]})})})]})};return Object(f.jsx)(t,{})}},{key:"getSpeedFactor",value:function(){return this.speedFactor}}]),i}(_t),qt=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.call(this,"Move Properties")}return i}(Yt),Zt=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.call(this,"Rotation Properties")}return i}(Yt),Jt=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.call(this,"Scale Properties")}return i}(Yt),Kt=new Xt;new Yt,new qt,new Zt,new Jt;function Qt(e){return null!==e&&"gizmoTool"in e}var $t=function(){function e(){Object(q.a)(this,e),this.properties=null}return Object(Z.a)(e,[{key:"renderToolPropertiesCard",value:function(){return this.properties?this.properties.drawPropertiesCard():Object(f.jsx)("div",{})}},{key:"onSelectPoint",value:function(e,t){}},{key:"onSelectEdge",value:function(e,t){}},{key:"onSelectFace",value:function(e,t){}},{key:"onSelectObject",value:function(e){}},{key:"onToolSelect",value:function(){}},{key:"getProperties",value:function(){return this.properties}}]),e}(),ei=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){var e;return Object(q.a)(this,i),(e=t.call(this)).properties=new qt,e}return Object(Z.a)(i,[{key:"gizmoTool",value:function(){}}]),i}($t),ti=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){var e;return Object(q.a)(this,i),(e=t.call(this)).properties=new Zt,e}return Object(Z.a)(i,[{key:"gizmoTool",value:function(){}}]),i}($t),ii=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){var e;return Object(q.a)(this,i),(e=t.call(this)).properties=new Jt,e}return Object(Z.a)(i,[{key:"gizmoTool",value:function(){}}]),i}($t),ni=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.apply(this,arguments)}return Object(Z.a)(i,[{key:"onSelectFace",value:function(e){}},{key:"subdivideFace",value:function(e,t){var i,n=t.getFaces(),a=n.indexOf(e);if(!(a<0)){n.splice(a,1);var s=Le(e.getPoints()),r=e.getPoints().map((function(e){return new $(e,s)})),o=e.getEdges().map((function(e){var t=e.getPoints(),i=[e];return r.forEach((function(e){Fe(t,e.getPoints()).length>0&&i.push(e)})),new ee(i)}));t.getPoints().push(s),(i=t.getEdges()).push.apply(i,Object(it.a)(r)),n.push.apply(n,Object(it.a)(o)),t.refreshBuffers()}}}]),i}($t),ai=new(function(){function e(){Object(q.a)(this,e),this.toolArray=[new ei,new ti,new ii,new ni]}return Object(Z.a)(e,[{key:"getToolByType",value:function(e){var t=this.toolArray.find((function(t){return t&&t instanceof e}));return t||null}}]),e}()),si=function(e){return{borderStyle:"solid",borderWidth:"0.1em 0",borderColor:null===e||void 0===e?void 0:e.colorMode.accentColor}};function ri(e){var t=Object(n.useContext)(mt),i=Object(n.useState)(ci.move),a=Object(o.a)(i,2),s=a[0],r=a[1],c=Object(n.useContext)(b),l=Object(n.useContext)(tt);function u(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;switch(t){case ci.move:n=ai.getToolByType(ei);break;case ci.rotate:n=ai.getToolByType(ti);break;case ci.scale:n=ai.getToolByType(ii);break;case ci.surfaceSubdivision:n=ai.getToolByType(ni)}return e.updateSelectedTool(n),i||r(t),null===l||void 0===l||l.refresh(),t}Object(n.useEffect)((function(){r(ci.move),e.updateSelectedTool(ai.getToolByType(ei))}),[t]);var h=mi.returnView();return Object(f.jsxs)("tbody",{children:[t&&(t.editMode===ui.point||t.editMode===ui.edge||t.editMode===ui.face)&&Object(f.jsx)("tr",{style:si(c),children:Object(f.jsx)("td",{children:Object(f.jsx)(E,{text:"Move",onClick:function(){s!==ci.move&&(u(ci.move),h.setGizmoMode(Pt.move))},className:"fill-parent-width",active:s===ci.move})})}),t&&(t.editMode===ui.edge||t.editMode===ui.face)&&Object(f.jsx)("tr",{style:si(c),children:Object(f.jsx)("td",{children:Object(f.jsx)(z,{text:"Rotate",onClick:function(){s!==ci.rotate&&(u(ci.rotate),h.setGizmoMode(Pt.rotate))},className:"fill-parent-width",active:s===ci.rotate})})}),t&&(t.editMode===ui.edge||t.editMode===ui.face)&&Object(f.jsx)("tr",{style:si(c),children:Object(f.jsx)("td",{children:Object(f.jsx)(I,{text:"Scale",onClick:function(){s!==ci.scale&&(u(ci.scale),h.setGizmoMode(Pt.scale))},className:"fill-parent-width",active:s===ci.scale})})}),t&&t.editMode===ui.face&&Object(f.jsx)("tr",{style:si(c),children:Object(f.jsx)("td",{children:Object(f.jsx)(R,{text:"Surface Subdivision",onClick:function(){s!==ci.surfaceSubdivision&&(u(ci.surfaceSubdivision),h.setGizmoMode(Pt.gizmoUnused))},className:"fill-parent-width",active:s===ci.surfaceSubdivision})})})]})}function oi(e){var t=Object(n.useContext)(tt);function i(i){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null;switch(i){case ci.move:a=ai.getToolByType(ei);break;case ci.rotate:a=ai.getToolByType(ti);break;case ci.scale:a=ai.getToolByType(ii)}return e.updateSelectedTool(a),n||c(i),null===t||void 0===t||t.refresh(),i}var a=Object(n.useState)(ci.move),s=Object(o.a)(a,2),r=s[0],c=s[1],l=Object(n.useContext)(b);Object(n.useEffect)((function(){e.updateSelectedTool(ai.getToolByType(ei))}),[]);var u=mi.returnView();return Object(f.jsxs)("tbody",{children:[Object(f.jsx)("tr",{style:si(l),children:Object(f.jsx)("td",{children:Object(f.jsx)(E,{text:"Move",onClick:function(){r!==ci.move&&(i(ci.move),u.setGizmoMode(Pt.move))},className:"fill-parent-width",active:r===ci.move})})}),Object(f.jsx)("tr",{style:si(l),children:Object(f.jsx)("td",{children:Object(f.jsx)(z,{text:"Rotate",onClick:function(){r!==ci.rotate&&(i(ci.rotate),u.setGizmoMode(Pt.rotate))},className:"fill-parent-width",active:r===ci.rotate})})}),Object(f.jsx)("tr",{style:si(l),children:Object(f.jsx)("td",{children:Object(f.jsx)(I,{text:"Scale",onClick:function(){r!==ci.scale&&(i(ci.scale),u.setGizmoMode(Pt.scale))},className:"fill-parent-width",active:r===ci.scale})})})]})}var ci,li=Object(n.createContext)(null);!function(e){e[e.move=0]="move",e[e.rotate=1]="rotate",e[e.scale=2]="scale",e[e.surfaceSubdivision=3]="surfaceSubdivision"}(ci||(ci={}));var ui,hi=new(function(){function e(){Object(q.a)(this,e),this.selectedTool=null}return Object(Z.a)(e,[{key:"returnToolsComponent",value:function(){var e=Object(n.useContext)(li),t=Object(n.useContext)(mt);return(null===e||void 0===e?void 0:e.appMode)===di.MainMode?Object(f.jsx)(oi,{updateSelectedTool:this.setSelectedTool.bind(this)}):t&&(null===e||void 0===e?void 0:e.appMode)===di.EditMode?Object(f.jsx)(ri,{updateSelectedTool:this.setSelectedTool.bind(this)}):Object(f.jsx)(f.Fragment,{})}},{key:"getSelectedToolByType",value:function(e){return this.selectedTool&&this.selectedTool instanceof e?this.selectedTool:null}},{key:"getSelectedTool",value:function(){return this.selectedTool}},{key:"setSelectedTool",value:function(e){this.selectedTool=e}}]),e}());!function(e){e.face="face",e.edge="edge",e.point="point"}(ui||(ui={}));var di,fi=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(e,n){var a;return Object(q.a)(this,i),(a=t.call(this)).obj=void 0,a.camera=void 0,a.canvasEvent=void 0,a.raycaster=void 0,a.renderer=void 0,a.cameraController=void 0,a.gizmo=void 0,a.gizmoPoint=void 0,a.leftMouseDown=!1,a.mode=ui.point,a.selectedPoint=null,a.selectedEdge=null,a.selectedFace=null,a.actualScaleFactor=void 0,a.originalSelectedEdge=null,a.originalSelectedFace=null,a.isSelected=!1,a.canvasEvent=n,a.obj=e,a.camera=new Ot,a.camera.setCanvasEvent(a.canvasEvent),a.renderer=new Ft(a.camera,a.obj),a.raycaster=new Ge(new We,e,Ne.point,!1),a.cameraController=new xt(a.camera,a.raycaster),a.gizmo=new Rt(a.camera,a.cameraController),a.gizmo.subscribeToGizmo(Object(jt.a)(a)),a.gizmoPoint=J.d.fromValues(0,0,0),a.actualScaleFactor=J.d.create(),a}return Object(Z.a)(i,[{key:"setMode",value:function(e){switch(this.mode=e,this.unselectAll(),e){case ui.point:this.raycaster.setMode(Ne.point|Ne.face);break;case ui.edge:this.raycaster.setMode(Ne.edge|Ne.face);break;case ui.face:this.raycaster.setMode(Ne.face)}this.gizmo.setMode(Pt.move),this.updateOriginals(),J.d.set(this.actualScaleFactor,1,1,1),this.gizmo.inactivate()}},{key:"setGizmoMode",value:function(e){e===Pt.gizmoUnused&&this.unselectAll(),this.gizmo.setMode(e),this.updateOriginals(),J.d.set(this.actualScaleFactor,1,1,1)}},{key:"renderView",value:function(){this.renderer.renderFrame(),this.gizmo.render()}},{key:"returnOnScreenMenu",value:function(){return Object(f.jsx)(gi,{})}},{key:"onMouseDown",value:function(e){var t;if(!this.cameraController.isCameraActive()&&!this.leftMouseDown){this.leftMouseDown=!0;var i=J.a.create();J.a.identity(i);var n=De(J.c.fromValues(e.offsetX/this.camera.getScreenDimensions()[0]*2-1,-e.offsetY/this.camera.getScreenDimensions()[1]*2+1),this.camera);if(this.raycaster.setRay(n),this.raycaster.setAreaRange(Ge.STANDARD_AREA_RANGE),!this.gizmo.raycastGizmo(n)&&!this.isSelected){var a=null===(t=hi.getSelectedTool())||void 0===t?void 0:t.getProperties();a&&a instanceof Yt&&this.raycaster.setAreaRange(a.getMouseProperties().getClickRaycastArea()),this.isSelected=!0;var s=this.raycaster.cast(i);if(this.unselectAll(),this.gizmo.inactivate(),J.d.set(this.actualScaleFactor,1,1,1),s&&s.length>0){var r=s[0],o=kt(r.hits);switch(this.mode){case ui.point:var c=function(e){var t=null;return e.pointsHits.forEach((function(e){t?e.distance<t.distance&&(t=e):t=e})),t}(r.hits);this.handlePointHits(c,o,r.hittedObject);break;case ui.edge:var l=function(e){var t=null;return e.edgesHits.forEach((function(e){t?e.distance<t.distance&&(t=e):t=e})),t}(r.hits);this.handleEdgeHits(l,o,r.hittedObject);break;case ui.face:this.handleFaceHits(o,r.hittedObject)}this.singleSelect()}}}}},{key:"onMouseUp",value:function(e){this.leftMouseDown=!1,this.isSelected=!1}},{key:"singleSelect",value:function(){var e=hi.getSelectedTool();if(e&&this.mode===ui.face&&e instanceof ni&&this.selectedFace){var t=this.obj.getMesh();t&&(e.subdivideFace(this.selectedFace,t),this.unselectAll())}}},{key:"unselectAll",value:function(){this.selectedPoint=null,this.selectedEdge=null,this.selectedFace=null,this.originalSelectedEdge=null,this.originalSelectedFace=null,this.renderer.unselectPoint(),this.renderer.unselectEdge(),this.renderer.unselectFace()}},{key:"handlePointHits",value:function(e,t,i){var n;e&&(!t||t&&e.distance<t.distance)?(this.selectedPoint=e.point,null===(n=hi.getSelectedTool())||void 0===n||n.onSelectPoint(this.selectedPoint,i),this.renderer.selectPoint(e.point),Qt(hi.getSelectedTool())&&(this.updateCenterPoint(e.point),this.gizmo.activate())):(this.renderer.unselectPoint(),this.selectedPoint=null,J.d.zero(this.gizmoPoint),this.gizmo.inactivate());this.gizmo.setPoint(this.gizmoPoint)}},{key:"handleEdgeHits",value:function(e,t,i){var n;e&&(!t||t&&e.distance<t.distance)?(console.log(e.distance,t?t.distance:"ss"),this.selectedEdge=e.edge,null===(n=hi.getSelectedTool())||void 0===n||n.onSelectEdge(this.selectedEdge,i),this.renderer.selectEdge(e.edge),Qt(hi.getSelectedTool())&&(this.updateCenterPoint(e.edge),this.gizmo.activate())):(this.renderer.unselectEdge(),J.d.zero(this.gizmoPoint),this.selectedEdge=null,this.gizmo.inactivate());this.gizmo.setPoint(this.gizmoPoint),this.updateOriginals()}},{key:"handleFaceHits",value:function(e,t){var i;e?(this.selectedFace=e.face,null===(i=hi.getSelectedTool())||void 0===i||i.onSelectFace(this.selectedFace,t),this.renderer.selectFace(e.face),Qt(hi.getSelectedTool())&&(this.updateCenterPoint(e.face),this.gizmo.activate())):(this.renderer.unselectFace(),J.d.zero(this.gizmoPoint),this.selectedFace=null,this.gizmo.inactivate());this.gizmo.setPoint(this.gizmoPoint),this.updateOriginals()}},{key:"unsubscribe",value:function(){yt.unsubscribe(this),this.gizmo.cleanUp(),this.cameraController.cleanUp()}},{key:"onMove",value:function(e,t,i){var n=J.d.create(),a=J.d.fromValues(e,t,i),s=ai.getToolByType(ei);if(s){var r=s.getProperties();J.d.scale(a,a,r?r.getSpeedFactor():1)}switch(J.d.add(n,this.gizmoPoint,a),this.gizmoPoint=n,this.gizmo.setPoint(n),this.mode){case ui.point:if(this.selectedPoint){console.log("f",this.selectedPoint,n),this.selectedPoint.setCords(n),console.log("a",this.selectedPoint);var o=[this.selectedPoint];this.refreshMeshBuffer(o)}break;case ui.edge:if(this.selectedEdge){var c=this.selectedEdge.getPoints();c.forEach((function(e){var t=J.d.create();J.d.add(t,e.getCords(),a),e.setCords(t)})),this.refreshMeshBuffer(c)}break;case ui.face:if(this.selectedFace){var l=this.selectedFace.getPoints();l.forEach((function(e){var t=J.d.create();J.d.add(t,e.getCords(),a),e.setCords(t)})),this.refreshMeshBuffer(l)}}}},{key:"onRotate",value:function(e,t,i){var n=J.d.create(),a=J.a.create(),s=J.a.create();J.a.fromTranslation(a,J.d.negate(n,this.gizmoPoint)),J.a.fromTranslation(s,this.gizmoPoint);var r=ai.getToolByType(ti),o=J.d.fromValues(e,t,i);if(r){var c=r.getProperties();J.d.scale(o,o,c?c.getSpeedFactor():1)}var l=function(e,t,i){var n=J.a.create();J.a.identity(n);var a=J.a.create();J.a.identity(a);var s=J.a.create(),r=J.a.create(),o=J.a.create();return J.a.fromXRotation(s,e),J.a.fromYRotation(r,t),J.a.fromZRotation(o,i),J.a.multiply(n,a,o),J.a.multiply(a,n,r),J.a.multiply(n,a,s),n}(o[0],o[1],o[2]);switch(this.mode){case ui.edge:if(this.selectedEdge){var u=this.selectedEdge.getPoints();u.forEach((function(e){var t=J.d.create(),i=J.d.create();J.d.transformMat4(i,e.getCords(),a),J.d.transformMat4(t,i,l),J.d.transformMat4(t,t,s),e.setCords(t)})),this.refreshMeshBuffer(u)}break;case ui.face:if(this.selectedFace){var h=this.selectedFace.getPoints();h.forEach((function(e){var t=J.d.create(),i=J.d.create();J.d.transformMat4(i,e.getCords(),a),J.d.transformMat4(t,i,l),J.d.transformMat4(t,t,s),e.setCords(t)})),this.refreshMeshBuffer(h)}}}},{key:"onScale",value:function(e,t,i){var n=J.d.fromValues(e,t,i),a=ai.getToolByType(ii);if(a){var s=a.getProperties();J.d.scale(n,n,s?s.getSpeedFactor():1)}var r=J.d.create(),o=J.a.create(),c=J.a.create(),l=J.a.create();switch(J.a.fromTranslation(o,J.d.negate(r,this.gizmoPoint)),J.a.fromTranslation(c,this.gizmoPoint),J.d.add(this.actualScaleFactor,this.actualScaleFactor,n),J.a.fromScaling(l,this.actualScaleFactor),this.mode){case ui.edge:if(this.originalSelectedEdge&&this.selectedEdge){var u,h=this.originalSelectedEdge.getPoints(),d=null===(u=this.selectedEdge)||void 0===u?void 0:u.getPoints();if(!d)return;h.forEach((function(e,t){var i=d[t];if(i){var n=J.d.create(),a=J.d.create();J.d.transformMat4(a,e.getCords(),o),J.d.transformMat4(n,a,l),J.d.transformMat4(n,n,c),i.setCords(n)}})),this.refreshMeshBuffer(d)}break;case ui.face:if(this.originalSelectedFace&&this.selectedFace){var f,g=this.originalSelectedFace.getPoints(),v=null===(f=this.selectedFace)||void 0===f?void 0:f.getPoints();if(!v)return;g.forEach((function(e,t){var i=v[t];if(i){console.log(i);var n=J.d.create(),a=J.d.create();J.d.transformMat4(a,e.getCords(),o),J.d.transformMat4(n,a,l),J.d.transformMat4(n,n,c),i.setCords(n)}})),this.refreshMeshBuffer(v)}}}},{key:"onStart",value:function(){this.updateOriginals(),J.d.set(this.actualScaleFactor,1,1,1)}},{key:"onFinish",value:function(){}},{key:"updateCenterPoint",value:function(e){if(e instanceof Q)J.d.copy(this.gizmoPoint,e.getCords());else{var t=Le(e.getPoints());J.d.copy(this.gizmoPoint,t.getCords())}}},{key:"refreshMeshBuffer",value:function(e){var t,i,n;e.forEach((function(e){e.recalculateBufferData()})),null===(t=this.obj.getMesh())||void 0===t||t.getEdges().forEach((function(t){Fe(e,t.getPoints()).length>0&&t.recalculateBufferData()})),null===(i=this.obj.getMesh())||void 0===i||i.getFaces().forEach((function(t){Fe(e,t.getPoints()).length>0&&t.recalculateBufferData()})),null===(n=this.obj.getMesh())||void 0===n||n.refreshBuffers()}},{key:"updateOriginals",value:function(){this.originalSelectedFace=this.selectedFace?this.selectedFace.copy():null,this.originalSelectedEdge=this.selectedEdge?this.selectedEdge.copy():null}}]),i}(Bt),gi=function(){var e=Object(n.useContext)(mt),t=function(t){null===e||void 0===e||e.setEditMode(t),mi.returnView().setMode(t)};return Object(n.useEffect)((function(){null===e||void 0===e||e.setEditMode(ui.point)}),[]),Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(bt.a,{style:{marginTop:"0.7rem",marginLeft:"0.7rem",borderRadius:"0.5rem"},children:[Object(f.jsx)(P,{onClick:function(){e&&e.editMode!==ui.point&&t(ui.point)},active:null!==e&&e.editMode===ui.point,ico:Object(f.jsx)(Vt.a,{style:{transform:"rotate(45deg)"}})}),Object(f.jsx)(P,{onClick:function(){e&&e.editMode!==ui.edge&&t(ui.edge)},active:null!==e&&e.editMode===ui.edge,ico:Object(f.jsx)(Lt.a,{style:{transform:"rotate(45deg)"}})}),Object(f.jsx)(P,{onClick:function(){e&&e.editMode!==ui.face&&t(ui.face)},active:null!==e&&e.editMode===ui.face,ico:Object(f.jsx)(Nt.a,{})})]})})},vi=function(){function e(t,i){Object(q.a)(this,e),this.camera=void 0,this.objToRender=void 0,this.camera=t,this.objToRender=i}return Object(Z.a)(e,[{key:"renderFrame",value:function(){K.clear(0,0,0,.3),K.viewport(),K.enableDepthTest(!0);var e=J.a.create();this.objToRender.renderObj(this.camera,J.a.identity(e))}}]),e}(),bi=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(e,n){var a;return Object(q.a)(this,i),(a=t.call(this)).renderer=void 0,a.obj=void 0,a.camera=void 0,a.canvasEvent=void 0,a.raycaster=void 0,a.cameraController=void 0,a.gizmo=void 0,a.gizmoPoint=void 0,a.leftMouseDown=!1,a.actualObjectWorldTransformation=J.a.create(),a.canvasEvent=n,a.obj=e,a.camera=new Ot,a.camera.setCanvasEvent(a.canvasEvent),a.renderer=new vi(a.camera,a.obj),a.raycaster=new Ge(new We,e,Ne.face,!0),a.cameraController=new xt(a.camera,a.raycaster),a.gizmo=new Rt(a.camera,a.cameraController),a.gizmo.subscribeToGizmo(Object(jt.a)(a)),a.gizmoPoint=J.d.fromValues(0,0,0),a.recalculateGizmoPosition(),a}return Object(Z.a)(i,[{key:"renderView",value:function(){this.renderer.renderFrame(),this.gizmo.render()}},{key:"returnOnScreenMenu",value:function(){return Object(f.jsx)(ji,{})}},{key:"setGizmoMode",value:function(e){this.gizmo.setMode(e)}},{key:"onMouseDown",value:function(e){var t;if(!this.cameraController.isCameraActive()&&!this.leftMouseDown){this.leftMouseDown=!0;var i=De(J.c.fromValues(e.offsetX/this.camera.getScreenDimensions()[0]*2-1,-e.offsetY/this.camera.getScreenDimensions()[1]*2+1),this.camera);if(this.raycaster.setRay(i),!this.gizmo.raycastGizmo(i)){var n,a=wt(this.raycaster.cast());if(ze.getSelectedObject())null===(n=ze.getSelectedObject())||void 0===n||n.unselect(),this.gizmo.inactivate();if(ze.setSelectedObject(a[0]?a[0].hittedObject:null),null===(t=a[0])||void 0===t?void 0:t.hittedObject){var s,r,o;null===(s=a[0])||void 0===s||s.hittedObject.select();var c=J.d.create(),l=J.d.create();J.d.copy(c,J.a.getTranslation(l,null===(r=a[0])||void 0===r?void 0:r.hittedObject.getWorldTransformMatrix())),J.d.copy(this.gizmoPoint,c),this.gizmo.setPoint(c),this.gizmo.activate(),J.a.copy(this.actualObjectWorldTransformation,null===(o=a[0])||void 0===o?void 0:o.hittedObject.getWorldTransformMatrix())}}}}},{key:"onStart",value:function(){var e=ze.getSelectedObject();e&&J.a.copy(this.actualObjectWorldTransformation,e.getWorldTransformMatrix())}},{key:"onFinish",value:function(){}},{key:"onMouseUp",value:function(e){this.leftMouseDown=!1}},{key:"onMove",value:function(e,t,i){var n,a,s=null===(n=ze.getSelectedObject())||void 0===n?void 0:n.getTransform(),r=null===(a=ze.getSelectedObject())||void 0===a?void 0:a.getParent(),o=ai.getToolByType(ei);if(s){var c=J.d.fromValues(e,t,i),l=null;o&&(l=o.getProperties(),J.d.scale(c,c,l?l.getSpeedFactor():1));var u=J.e.create(),h=J.e.fromValues(c[0],c[1],c[2],0);if(r){var d=J.a.create();J.a.invert(d,r.getWorldTransformMatrix()),J.e.transformMat4(u,h,d)}else J.e.copy(u,h);var f=u[3]?u[3]:1,g=J.d.fromValues(u[0]/f,u[1]/f,u[2]/f),v=J.d.create(),b=s.getPositionInParent();s.setPositionInParent(J.d.add(v,b,g));var j=J.d.fromValues(e,t,i);o&&J.d.scale(j,j,l?l.getSpeedFactor():1),J.d.add(this.gizmoPoint,this.gizmoPoint,j),this.gizmo.setPoint(this.gizmoPoint),Ee.refresh()}}},{key:"onRotate",value:function(e,t,i){var n=ze.getSelectedObject(),a=null===n||void 0===n?void 0:n.getTransform();null===n||void 0===n||n.getParent();if(a){var s=ai.getToolByType(ti),r=J.d.fromValues(e,t,i);if(s){var o=s.getProperties();J.d.scale(r,r,o?o.getSpeedFactor():1)}var c=J.d.create(),l=a.getOrientationInParent();a.setOrientationInParent(J.d.add(c,l,r)),Ee.refresh()}}},{key:"onScale",value:function(e,t,i){var n=ze.getSelectedObject(),a=null===n||void 0===n?void 0:n.getTransform(),s=null===n||void 0===n?void 0:n.getParent();if(a){var r=J.d.fromValues(e,t,i),o=ai.getToolByType(ii);if(o){var c=o.getProperties();J.d.scale(r,r,c?c.getSpeedFactor():1)}var l=J.e.create();if(s){var u=J.a.create(),h=J.a.create(),d=J.b.create(),f=J.d.create();J.a.getRotation(d,this.actualObjectWorldTransformation),J.a.getTranslation(f,this.actualObjectWorldTransformation),J.a.fromRotationTranslation(h,d,f),J.a.invert(u,h),J.e.transformMat4(l,[e,t,i,0],u)}else J.e.copy(l,[e,t,i,0]);var g=l[3]?l[3]:1,v=J.d.fromValues(l[0]/g,l[1]/g,l[2]/g);!function(e,t){var i;t=(i=t)<0?-1:i>0?1:0,e.forEach((function(i,n){var a=Math.abs(i);e[n]=a*t}))}(v,e+t+i),console.log(v,[e,t,i],[l[0],l[1],l[2]]);var b=J.d.create(),j=a.getScaleInParent();a.setScaleInParent(J.d.add(b,j,v)),Ee.refresh()}}},{key:"unsubscribe",value:function(){yt.unsubscribe(this),this.gizmo.cleanUp(),this.cameraController.cleanUp()}},{key:"recalculateGizmoPosition",value:function(){var e=ze.getSelectedObject(),t=J.d.create();this.gizmo.inactivate(),e&&(J.a.getTranslation(t,e.getWorldTransformMatrix()),J.d.copy(this.gizmoPoint,t),this.gizmo.setPoint(this.gizmoPoint),this.gizmo.activate())}}]),i}(Bt),ji=function(){return Object(f.jsx)(f.Fragment,{})},mi=new(function(){function e(){Object(q.a)(this,e),this.actualView=null,this.canvasEvent=null}return Object(Z.a)(e,[{key:"init",value:function(e){this.canvasEvent=e,this.enableMainView()}},{key:"returnView",value:function(){return this.actualView}},{key:"renderViewWorld",value:function(){var e;null===(e=this.actualView)||void 0===e||e.renderView()}},{key:"setActualView",value:function(e){this.actualView&&this.actualView.unsubscribe(),this.actualView=e}},{key:"enableMainView",value:function(){var e=ze.getWorld();if(!e||!this.canvasEvent)throw new Error("World is not loaded");this.setActualView(new bi(e,this.canvasEvent))}},{key:"enableEditView",value:function(){var e=ze.getSelectedObject();if(!e||!this.canvasEvent)throw new Error("None object is selected");if(!e.getMesh())throw new Error("Selected object has no mesh");this.setActualView(new fi(e,this.canvasEvent))}},{key:"returnOnScreenMenu",value:function(e){return Object(f.jsx)(Oi,{viewId:e,component:this.actualView?this.actualView.returnOnScreenMenu():void 0})}}]),e}()),Oi=function(e){return Object(f.jsx)(f.Fragment,{children:e.component})};!function(e){e[e.MainMode=0]="MainMode",e[e.EditMode=1]="EditMode"}(di||(di={}));var pi,yi=function(){var e=Object(n.useContext)(b),t=Object(n.useContext)(li),i=Object(n.useContext)(H),a=Object(n.useState)(0),s=Object(o.a)(a,2),r=s[0],c=s[1],l=Object(n.useRef)(null),u=Object(n.useRef)(null);function h(e){t&&(t.setAppMode(e),c(e))}return Object(f.jsx)("div",{style:{width:"100%"},children:Object(f.jsx)(g,{backgroundColor:null===e||void 0===e?void 0:e.colorMode.backgroundColor,borderColor:null===e||void 0===e?void 0:e.colorMode.accentColor,borderWidth:2,children:Object(f.jsxs)(bt.a,{children:[Object(f.jsx)(P,{text:"Layout",buttonRef:l,ico:Object(f.jsx)(D.e,{}),onClick:function(){0!==r&&(h(0),mi.enableMainView())},active:0===r}),Object(f.jsx)(P,{text:"Edit",buttonRef:u,ico:Object(f.jsx)(D.d,{}),onClick:function(){if(1!==r)try{h(1),mi.enableEditView()}catch(t){var e=t.message;null===i||void 0===i||i.setModalData({header:"Warning",body:Object(f.jsx)(f.Fragment,{children:e})}),null===i||void 0===i||i.open(),u&&u.current&&u.current.blur&&u.current.blur(),h(r)}},active:1===r})]})})})},xi=(i(289),function(e){Object(n.useContext)(b);return Object(f.jsx)("div",{children:Object(f.jsx)("table",{className:"fill-parent-width",children:hi.returnToolsComponent()})})}),ki=i(105),wi=(i(167),i(66)),Si=i(218),Mi=i(459),Ci=i(81),Pi=i.n(Ci),Ti=i(215),Ei=function(e){switch(e.nodeType){case"object":return Object(f.jsx)(C.a,{});default:return Object(f.jsx)(f.Fragment,{})}},zi=Ti.a.span(pi||(pi=Object(wi.a)(["\nborder-radius: 0.2em;\npadding-right: 0.5em;\ncolor: ",";\nbackground-color: ",";\n&:hover {\n  background-color: \n    rgba(",", \n    ",", \n    ",", 0.5);\n}\n"])),(function(e){var t,i;return e.isSelected?null===(t=e.colorMode)||void 0===t?void 0:t.colorMode.accentColor:null===(i=e.colorMode)||void 0===i?void 0:i.colorMode.primaryColor}),(function(e){var t;return e.isSelected?null===(t=e.colorMode)||void 0===t?void 0:t.colorMode.secondaryColor:""}),(function(e){return e.backgroundColor.r}),(function(e){return e.backgroundColor.g}),(function(e){return e.backgroundColor.b})),Ii=function(e){var t,i=Object(n.useContext)(b),a=Object(n.useContext)(tt),s=Object(ki.b)(e.node.id,e.isOpen,e.onToggle),r="calc(".concat(e.depth," * 1em"),o=Pi.a.hex.rgb(null===i||void 0===i?void 0:i.colorMode.secondaryColor);return Object(f.jsxs)("span",Object(d.a)(Object(d.a)({className:"node-element",style:{paddingInlineStart:r}},s),{},{children:[Object(f.jsx)(Mi.a,{}),Object(f.jsx)("span",{style:{width:"1em",color:null===i||void 0===i?void 0:i.colorMode.primaryColor},children:e.node.droppable&&e.node.data&&(null===(t=e.node.data)||void 0===t?void 0:t.getChildrenList().length)>0&&Object(f.jsx)("span",{onClick:function(t){t.stopPropagation(),e.onToggle(e.node.id)},children:Object(f.jsx)(Si.a,{className:"expand-icon ".concat(e.isOpen?"expanded":"")})})}),Object(f.jsx)(zi,{isSelected:e.isSelected,colorMode:i,backgroundColor:{r:o[0],g:o[1],b:o[2]},children:Object(f.jsxs)("span",{onClick:function(){e.onSelect&&e.onSelect(e.node)},children:[Object(f.jsx)("span",{style:{width:"1em",paddingLeft:"0.5em"},children:Object(f.jsx)(Ei,{nodeType:"object"})}),Object(f.jsx)("span",{style:{paddingLeft:"0.2em"},children:e.node.text}),"root"!==e.node.parent&&Object(f.jsx)("span",{style:{marginLeft:"0.2em"},onClick:function(t){t.stopPropagation(),e.node.data&&(Ri(e.node.data),null===a||void 0===a||a.refresh())},children:Object(f.jsx)(x.b,{})})]})})]}))},Ri=function e(t){t.getChildrenList().forEach((function(t){return e(t)}));var i=t.getParent();if(i&&i.removeChild(t),t.setParent(null),ze.getSelectedObject()===t){ze.setSelectedObject(null);var n=mi.returnView();n&&n.recalculateGizmoPosition&&n.recalculateGizmoPosition()}},Ai=function(e){var t=Object(n.useContext)(b),i=e.monitorProps.item;return Object(f.jsx)("span",{className:"node-element-drag",style:{color:null===t||void 0===t?void 0:t.colorMode.secondaryColor,backgroundColor:null===t||void 0===t?void 0:t.colorMode.accentColor},children:i.text})},Fi=function(){var e=Object(n.useContext)(b),t=Object(n.useContext)(et),i=Object(n.useContext)(li),a=Object(n.useState)([]),s=Object(o.a)(a,2),r=s[0],c=s[1],l=Object(n.useState)(null),u=Object(o.a)(l,2),h=u[0],d=u[1],v=ze.getWorld(),j=function(){var e=mi.returnView();e&&e.recalculateGizmoPosition&&e.recalculateGizmoPosition()},m=function(e){var t,i;null===(t=ze.getSelectedObject())||void 0===t||t.unselect(),ze.setSelectedObject(e.data?e.data:null),null===(i=e.data)||void 0===i||i.select(),j()};return Object(n.useEffect)((function(){c(function(){var e=ze.getWorld(),t=[];function i(e){var t=e.getParent();return{id:e.getId(),parent:t?t.getId():"root",text:e.getName(),droppable:!0,data:e}}function n(e){t.push(i(e)),e.getChildrenList().forEach((function(e){n(e)}))}e&&n(e);return t}())}),[,t]),Object(n.useEffect)((function(){var e=r.find((function(e){return e.data===ze.getSelectedObject()}));d(e||null)}),[t]),Object(f.jsx)(g,{style:{height:"100%"},backgroundColor:null===e||void 0===e?void 0:e.colorMode.backgroundColor,children:Object(f.jsx)(W,{disabled:function(){if(i)switch(i.appMode){case di.EditMode:return!0;default:return!1}return!0}(),children:Object(f.jsx)(Wt,{className:"tree-view",children:Object(f.jsx)("div",{className:"tree-view",children:Object(f.jsx)(ki.a,{tree:r,rootId:v?"root":"",render:function(e,t){var i=t.depth,n=t.isOpen,a=t.onToggle;return Object(f.jsx)(Ii,{node:e,depth:i,isOpen:n,isSelected:e.id===(null===h||void 0===h?void 0:h.id),onToggle:a,onSelect:m})},onDrop:function(e){c(e),v&&(!function(e,t){e.forEach((function(t){if(t.data){var i=t.data.getParent();if(i&&t.parent!==i.getId()){i.removeChild(t.data);var n=e.find((function(e){return e.id===t.parent}));n&&n.data&&n.data.addChild(t.data)}}}))}(e),j())},dragPreviewRender:function(e){return Object(f.jsx)(Ai,{monitorProps:e})},classes:{root:"treeRoot",draggingSource:"draggingSource",dropTarget:"dropTarget"}})})})})})};var Bi=i(219),Li=new(function(){function e(){Object(q.a)(this,e),this.gl=void 0,this.renderer=void 0,this.mainCamera=void 0,this.cameraController=void 0,this.canvasEvent=void 0,this.raycaster=void 0,this.viewManager=void 0,this.world=void 0,this.canvas=void 0,this.gl=null,this.renderer=null,this.mainCamera=null,this.cameraController=null,this.canvasEvent=null,this.raycaster=null,this.canvas=null,this.viewManager=mi,this.world=new Ke,this.world.setName("root")}return Object(Z.a)(e,[{key:"init",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.gl=e,this.canvas=t,this.canvasEvent=i,K.initUtils(this.gl,t);var n=new Ke;n.setMesh(new $e((new ie).setRadialSegments(4).build()));var a=new Ke;a.setTransform((new Ve).setPositionInParent([2,2,2])),a.setMesh(new $e((new re).build())),n.addChild(a),this.world.addChild(n);var s=new Ke;s.setMesh(new $e((new re).setXHalfWidth(.5).setYHalfWidth(.5).setZHalfWidth(.5).build())),s.setTransform((new Ve).setPositionInParent([0,0,5])),this.world.addChild(s),ze.setWorld(this.world),yt.init(),pt.init(),this.canvasEvent?(Ze.init(),mi.init(i)):console.error("Canvas Event not initialized. Application shutdown.")}},{key:"updateContext",value:function(e){this.gl=e,K.initUtils(this.gl,this.canvas),yt.init(),pt.init()}},{key:"intiRenderLoop",value:function(){this.gl&&window.requestAnimationFrame(this.render.bind(this))}},{key:"render",value:function(){mi.renderViewWorld(),window.requestAnimationFrame(this.render.bind(this))}}]),e}()),Ni=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(){return Object(q.a)(this,i),t.apply(this,arguments)}return Object(Z.a)(i,[{key:"triggerOnResize",value:function(e,t,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.getListeners().forEach((function(s){s.onResize(e,t,i,n,a)})),this.refresh()}}]),i}(Te),Vi=(new Ni,function(){var e=Object(n.useContext)(b),t=Object(n.useContext)(li),i=Object(Bi.a)(),a=i.width,s=i.height,r=i.ref,c=Object(n.useState)(null),l=Object(o.a)(c,2),u=l[0],h=l[1];return Object(n.useEffect)((function(){var e=document.querySelector("#canvas"),t=e.getContext("webgl"),i=new Ni;t?(h(i),Li.init(t,e,i),Li.intiRenderLoop()):alert("WebGL not initialized properly.")}),[]),Object(n.useEffect)((function(){var e=document.querySelector("#canvas");u&&u.triggerOnResize(window.scrollY+e.getBoundingClientRect().top,window.scrollX+e.getBoundingClientRect().left,e.width,e.height,"canvas")}),[a,s]),Object(f.jsx)(g,{backgroundColor:null===e||void 0===e?void 0:e.colorMode.backgroundColor,borderColor:null===e||void 0===e?void 0:e.colorMode.accentColor,borderWidth:2,style:{height:"100%"},children:Object(f.jsxs)("div",{id:"canvasFrame",ref:r,style:{height:"100%",width:"100%",margin:0,position:"relative"},children:[Object(f.jsx)("div",{style:{zIndex:2,position:"absolute",top:0},children:mi.returnOnScreenMenu(t?t.appMode:di.MainMode)}),Object(f.jsx)("canvas",{style:{zIndex:1,position:"absolute",top:"0",left:"0",right:"0",bottom:"0"},id:"canvas",width:a,height:s})]})})});Vi.displayName="Viewport";var Gi=Vi,Wi=i(225),Di={hex:"#000",rgb:{r:0,g:0,b:0,a:1},hsl:{h:0,s:0,l:0,a:1}},Hi=function(){var e=ze.getSelectedObject();if(!e)return Di;var t=e.getMaterial().getFaceMaterial().getColor(),i={r:Math.trunc(255*t[0]),g:Math.trunc(255*t[1]),b:Math.trunc(255*t[2]),a:t[3]},n=Pi.a.rgb.hsl(i.r,i.g,i.b),a={h:n[0],s:n[1],l:n[2],a:t[3]};return{hex:"#"+Pi.a.rgb.hex(i.r,i.g,i.b),rgb:i,hsl:a}},Ui=function(){var e=Object(n.useContext)(et),t=Object(n.useContext)(b),i=Object(n.useContext)(H),a=Object(n.useState)(Hi()),s=Object(o.a)(a,2),r=s[0],c=s[1],l=Object(n.useState)(!1),u=Object(o.a)(l,2),h=u[0],d=u[1],g=Object(n.useRef)(null);Object(n.useEffect)((function(){(null===i||void 0===i?void 0:i.isOpen)&&h&&v()}),[r,null===i||void 0===i?void 0:i.isOpen,h]),Object(n.useEffect)((function(){h&&d(!!i&&i.isOpen)}),[null===i||void 0===i?void 0:i.isOpen]),Object(n.useEffect)((function(){c(Hi())}),[,e]);var v=function(){null===i||void 0===i||i.setModalData({header:"Choose color",body:Object(f.jsx)("div",{children:Object(f.jsx)(Wi.a,{color:r.rgb,width:"auto",onChange:function(e){c(e)}})}),onClose:function(){return c(g.current?g.current:Di),!0},onCancel:function(){return c(g.current?g.current:Di),!0},onOk:function(){var e;return null===(e=ze.getSelectedObject())||void 0===e||e.getMaterial().getFaceMaterial().setColor([r.rgb.r/255,r.rgb.g/255,r.rgb.b/255,r.rgb.a]),!0}})};return Object(f.jsx)(Dt,{children:Object(f.jsx)(Ut,{label:"albedo",children:Object(f.jsx)("span",{onClick:function(){v(),null===i||void 0===i||i.open(),g.current=r,d(!0)},style:{alignSelf:"center",backgroundColor:r.hex,width:"1em",height:"1em",borderStyle:"solid",borderWidth:"2px",borderRadius:"2px",borderColor:null===t||void 0===t?void 0:t.colorMode.accentColor}})})})},_i=function(){var e=ze.getSelectedObject();if(!e)return{exists:!1,isEnabled:!1};var t=e.getMesh();return t?{exists:!0,isEnabled:t.isEnabled()}:{exists:!1,isEnabled:!1}},Xi=function(){var e=Object(n.useContext)(et),t=Object(n.useState)(_i()),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(a.isEnabled),c=Object(o.a)(r,2),l=c[0],u=c[1];return Object(n.useEffect)((function(){var e=_i();s(e),u(e.isEnabled)}),[,e]),Object(f.jsx)(Dt,{children:Object(f.jsx)(Ut,{label:"show mesh",children:Object(f.jsx)(B,{checked:l,disabled:!a.exists,onChange:function(e){var t,i;u(e.target.checked),null===(t=ze.getSelectedObject())||void 0===t||null===(i=t.getMesh())||void 0===i||i.enableDisable(e.target.checked)}})})})},Yi=(i(194),function(){var e=Object(n.useContext)(et),t=Object(n.useContext)(tt),i=Object(n.useState)(""),a=Object(o.a)(i,2),s=a[0],r=a[1],c=Object(n.useState)(""),l=Object(o.a)(c,2),u=l[0],h=l[1],d=Object(n.useState)(!1),g=Object(o.a)(d,2),v=g[0],b=g[1];return Object(n.useEffect)((function(){var e=ze.getSelectedObject();e&&h(e.getName())}),[,e]),Object(f.jsx)(Ut,{label:"Object name",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{className:"mb-1",disabled:!0,value:u}),Object(f.jsx)(G,{children:Object(f.jsx)(F,{invalid:v,onChange:function(e){b(!1),r(e.target.value)},onConfirm:function(e){if(s){var i=ze.getSelectedObject();i&&t&&(i.setName(s),r(""),t.refresh())}else b(!0)},onFocus:function(){return r("")},value:s})}),Object(f.jsx)(X.a,{className:"input-error",style:{display:v?"block":"none"},children:"Provided value is invalid"})]})})}),qi=function(e){e.invalid;return Object(f.jsx)(X.a,{className:"input-error",children:"Provided value is invalid"})},Zi=function(){Object(n.useContext)(b),Object(n.useContext)(H);var e=Object(n.useContext)(et),t=Object(n.useState)(null),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),l=c[0],u=c[1],h=Object(n.useState)(!1),d=Object(o.a)(h,2),g=d[0],v=d[1],j=Object(n.useState)(!1),m=Object(o.a)(j,2),O=m[0],p=m[1],y=Object(n.useState)(!1),x=Object(o.a)(y,2),k=x[0],w=x[1],S=Object(n.useState)(["","",""]),M=Object(o.a)(S,2),C=M[0],P=M[1],T=Object(n.useState)(!1),E=Object(o.a)(T,2),z=E[0],I=E[1],R=Object(n.useState)(!1),F=Object(o.a)(R,2),B=F[0],L=F[1],N=Object(n.useState)(!1),G=Object(o.a)(N,2),W=G[0],D=G[1],U=Object(n.useState)(["","",""]),_=Object(o.a)(U,2),X=_[0],Y=_[1],q=Object(n.useState)(!1),Z=Object(o.a)(q,2),J=Z[0],K=Z[1],Q=Object(n.useState)(!1),$=Object(o.a)(Q,2),ee=$[0],te=$[1],ie=Object(n.useState)(!1),ne=Object(o.a)(ie,2),ae=ne[0],se=ne[1],re=Object(n.useState)(["","",""]),oe=Object(o.a)(re,2),ce=oe[0],le=oe[1];Object(n.useEffect)((function(){var e=ze.getSelectedObject();a!==e&&s(e),P([e?e.getTransform().getPositionInParent()[0].toString():"",e?e.getTransform().getPositionInParent()[1].toString():"",e?e.getTransform().getPositionInParent()[2].toString():""]),Y([e?Re(e.getTransform().getOrientationInParent()[0]).toString():"",e?Re(e.getTransform().getOrientationInParent()[1]).toString():"",e?Re(e.getTransform().getOrientationInParent()[2]).toString():""]),le([e?e.getTransform().getScaleInParent()[0].toString():"",e?e.getTransform().getScaleInParent()[1].toString():"",e?e.getTransform().getScaleInParent()[2].toString():""]),g&&v(!1),O&&p(!1),k&&w(!1),z&&I(!1),B&&L(!1),W&&D(!1),J&&K(!1),ee&&te(!1),ae&&se(!1)}),[e]);var ue=function(e,t,i,n,a,s,r,o,c){var h=e.currentTarget.value,d=parseFloat(h),f=n();r([0===i?h:s[0],1===i?h:s[1],2===i?h:s[2]]),isNaN(d)?(t(!0),a([0===i?c?c(o):o:f[0],1===i?c?c(o):o:f[1],2===i?c?c(o):o:f[2]])):(a([0===i?c?c(d):d:f[0],1===i?c?c(d):d:f[1],2===i?c?c(d):d:f[2]]),t(!1),u(!l))};return a?Object(f.jsxs)(Wt,{children:[ze.getSelectedObject()!==ze.getWorld()&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(Ht,{className:"mg-b--em",children:"Details"}),Object(f.jsx)(Dt,{children:Object(f.jsx)(Yi,{})})]}),Object(f.jsx)(Ht,{className:"mg-t--em",children:"Transformations"}),Object(f.jsxs)(Dt,{title:"position",children:[Object(f.jsx)(Ut,{label:"x",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:g,value:C[0],onChange:function(e){ue(e,v,0,a.getTransform().getPositionInParent.bind(a.getTransform()),a.getTransform().setPositionInParent.bind(a.getTransform()),C,P,0);var t=mi.returnView();t&&t.recalculateGizmoPosition&&t.recalculateGizmoPosition()}}),Object(f.jsx)(qi,{invalid:g})]})}),Object(f.jsx)(Ut,{label:"y",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:O,value:C[1],onChange:function(e){ue(e,p,1,a.getTransform().getPositionInParent.bind(a.getTransform()),a.getTransform().setPositionInParent.bind(a.getTransform()),C,P,0);var t=mi.returnView();t&&t.recalculateGizmoPosition&&t.recalculateGizmoPosition()}}),Object(f.jsx)(qi,{invalid:O})]})}),Object(f.jsx)(Ut,{label:"z",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:k,value:C[2],onChange:function(e){ue(e,w,2,a.getTransform().getPositionInParent.bind(a.getTransform()),a.getTransform().setPositionInParent.bind(a.getTransform()),C,P,0);var t=mi.returnView();t&&t.recalculateGizmoPosition&&t.recalculateGizmoPosition()}}),Object(f.jsx)(qi,{invalid:k})]})})]}),Object(f.jsxs)(Dt,{title:"orientation",children:[Object(f.jsx)(Ut,{label:"x",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:z,value:X[0],onChange:function(e){ue(e,I,0,a.getTransform().getOrientationInParent.bind(a.getTransform()),a.getTransform().setOrientationInParent.bind(a.getTransform()),X,Y,0,Ie)}}),Object(f.jsx)(qi,{invalid:z})]})}),Object(f.jsx)(Ut,{label:"y",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:B,value:X[1],onChange:function(e){ue(e,L,1,a.getTransform().getOrientationInParent.bind(a.getTransform()),a.getTransform().setOrientationInParent.bind(a.getTransform()),X,Y,0,Ie)}}),Object(f.jsx)(qi,{invalid:B})]})}),Object(f.jsx)(Ut,{label:"z",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:W,value:X[2],onChange:function(e){ue(e,D,2,a.getTransform().getOrientationInParent.bind(a.getTransform()),a.getTransform().setOrientationInParent.bind(a.getTransform()),X,Y,0,Ie)}}),Object(f.jsx)(qi,{invalid:W})]})})]}),Object(f.jsxs)(Dt,{title:"scale",children:[Object(f.jsx)(Ut,{label:"x",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:J,value:ce[0],onChange:function(e){ue(e,K,0,a.getTransform().getScaleInParent.bind(a.getTransform()),a.getTransform().setScaleInParent.bind(a.getTransform()),ce,le,1)}}),Object(f.jsx)(qi,{invalid:J})]})}),Object(f.jsx)(Ut,{label:"y",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:ee,value:ce[1],onChange:function(e){ue(e,te,1,a.getTransform().getScaleInParent.bind(a.getTransform()),a.getTransform().setScaleInParent.bind(a.getTransform()),ce,le,1)}}),Object(f.jsx)(qi,{invalid:ee})]})}),Object(f.jsx)(Ut,{label:"z",children:Object(f.jsxs)(V,{children:[Object(f.jsx)(A,{invalid:ae,value:ce[2],onChange:function(e){ue(e,se,2,a.getTransform().getScaleInParent.bind(a.getTransform()),a.getTransform().setScaleInParent.bind(a.getTransform()),ce,le,1)}}),Object(f.jsx)(qi,{invalid:ae})]})})]}),Object(f.jsx)(Ht,{className:"mg-t--em mg-b--em",children:"Mesh"}),Object(f.jsx)(Xi,{}),Object(f.jsx)(Ht,{className:"mg-t--em mg-b--em",children:"Material"}),Object(f.jsx)(Ui,{})]}):Object(f.jsx)(Wt,{})},Ji=function(){Object(n.useContext)(et);var e=Object(n.useContext)(b),t=Object(n.useState)(!0),i=Object(o.a)(t,2),a=i[0],s=(i[1],hi.getSelectedTool()),r=s?s.renderToolPropertiesCard():Object(f.jsx)(f.Fragment,{});return Object(f.jsx)(g,{style:{height:"100%",backgroundColor:null===e||void 0===e?void 0:e.colorMode.backgroundColor},children:Object(f.jsx)(Wt,{children:a&&null!==s?r:Object(f.jsx)("div",{})})})},Ki=function(){var e=Object(n.useContext)(b);return Object(f.jsx)("div",{style:{width:"100%"},children:Object(f.jsx)(g,{backgroundColor:null===e||void 0===e?void 0:e.colorMode.backgroundColor,borderColor:null===e||void 0===e?void 0:e.colorMode.accentColor,borderWidth:2,children:"\xa0"})})},Qi=function(e){Object(Ce.a)(i,e);var t=Object(Pe.a)(i);function i(e){var n;return Object(q.a)(this,i),(n=t.call(this,e)).state={refreshVal:!1},Ee.subscribe(Object(jt.a)(n)),n}return Object(Z.a)(i,[{key:"onRefresh",value:function(){this.setState({refreshVal:!this.state.refreshVal})}},{key:"render",value:function(){var e=this;return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(et.Provider,{value:{value:this.state.refreshVal},children:Object(f.jsx)(tt.Provider,{value:{refresh:function(){return e.setState({refreshVal:!e.state.refreshVal})}},children:this.props.children})})})}}]),i}(a.a.Component),$i=i(454),en=i(447),tn=i(448),nn=i(449),an=function(e){var t=Object(n.useState)(!1),i=Object(o.a)(t,2),a=i[0],s=i[1],r=Object(n.useState)(null),c=Object(o.a)(r,2),l=c[0],u=c[1];return Object(f.jsxs)(H.Provider,{value:{open:function(){return s(!0)},setModalData:u,isOpen:a},children:[Object(f.jsxs)($i.a,Object(d.a)(Object(d.a)({},l&&l.modalSettings?l.modalSettings:{}),{},{isOpen:a,toggle:function(){return s(!a)},className:e.className,style:e.style,returnFocusAfterClose:!1,children:[Object(f.jsx)(en.a,{toggle:function(e){var t=!0;l&&l.onClose&&(t=l.onClose(e)),t&&s(!a)},children:l&&l.header?l.header:""}),Object(f.jsx)(tn.a,{children:l&&l.body?l.body:""}),Object(f.jsxs)(nn.a,{children:[Object(f.jsx)(j.a,{color:"primary",onClick:function(e){var t=!0;l&&l.onOk&&(t=l.onOk(e)),t&&s(!a)},children:"Ok"})," ",Object(f.jsx)(j.a,{color:"secondary",onClick:function(e){var t=!0;l&&l.onCancel&&(t=l.onCancel(e)),t&&s(!a)},children:"Cancel"})]})]})),e.children]})},sn=300,rn=100,on=function(){var e=Object(n.useState)({widthLeftHor:sn,heightLeftHor:sn}),t=Object(o.a)(e,2),i=t[0],a=i.widthLeftHor,s=i.heightLeftHor,r=t[1],h=Object(n.useState)({widthLeftVer:sn,heightLeftVer:sn}),d=Object(o.a)(h,2),g=d[0],v=g.widthLeftVer,j=g.heightLeftVer,m=d[1],O=Object(n.useState)({widthRightHor:sn,heightRightHor:sn}),p=Object(o.a)(O,2),y=p[0],x=y.widthRightHor,k=y.heightRightHor,w=p[1],S=Object(n.useState)({widthRightVer:sn,heightRightVer:sn}),M=Object(o.a)(S,2),C=M[0],P=C.widthRightVer,T=C.heightRightVer,E=M[1],z=Object(n.useState)({subWindowWidth:0,subWindowHeight:0}),I=Object(o.a)(z,2),R=I[0],A=R.subWindowWidth,F=R.subWindowHeight,B=I[1],L=Object(n.useState)(di.MainMode),N=Object(o.a)(L,2),V=N[0],G=N[1],W=Object(n.useState)(ui.point),D=Object(o.a)(W,2),H=D[0],U=D[1],_=Object(n.useState)(!1),X=Object(o.a)(_,2);X[0],X[1];Object(n.useEffect)((function(){r({widthLeftHor:a,heightLeftHor:F}),w({widthRightHor:x,heightRightHor:F}),m({widthLeftVer:v,heightLeftVer:F/2}),E({widthRightVer:P,heightRightVer:F/2})}),[A,F]),Object(n.useEffect)((function(){m({widthLeftVer:a,heightLeftVer:j})}),[j,a]),Object(n.useEffect)((function(){E({widthRightVer:x,heightRightVer:T})}),[T,x]),Object(n.useEffect)((function(){var e=document.querySelector("#resizableMain");e&&B({subWindowWidth:e.clientWidth,subWindowHeight:e.clientHeight})}),[]);var Y=Object(n.useContext)(b);return Object(f.jsx)(Qi,{children:Object(f.jsx)(an,{children:Object(f.jsx)(li.Provider,{value:{appMode:V,setAppMode:G},children:Object(f.jsx)(mt.Provider,{value:{editMode:H,setEditMode:U},children:Object(f.jsxs)("div",{style:{backgroundColor:null===Y||void 0===Y?void 0:Y.colorMode.backgroundColor,height:"100%",display:"flex",flexFlow:"column"},children:[Object(f.jsx)(vt,{}),Object(f.jsxs)("div",{id:"resizableMain",style:{position:"relative",height:"100%",flexGrow:1},children:[Object(f.jsx)(c.Resizable,{style:{position:"relative"},width:a,height:s,resizeHandles:["e"],handle:Object(f.jsx)("div",{style:{position:"absolute",right:"0",top:"0",width:"10px",height:"100%",float:"right"}}),onResize:function(e,t){t.element;var i=t.size;t.handle;i.width+x+300<A&&i.width>100&&r({widthLeftHor:i.width,heightLeftHor:i.height})},children:Object(f.jsxs)("div",{style:{display:"flex",flexFlow:"column",width:a+"px",height:s+"px"},children:[Object(f.jsx)(c.Resizable,{style:{position:"relative"},width:v,height:j,resizeHandles:["s"],onResize:function(e,t){t.element;var i=t.size;t.handle;i.height>rn&&F-i.height>rn&&m({widthLeftVer:i.width,heightLeftVer:i.height})},handle:Object(f.jsx)("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"10px"}}),children:Object(f.jsxs)("div",{style:{width:v+"px",height:j+"px"},children:[Object(f.jsx)(Gt,{title:"Tools"}),Object(f.jsx)(l.Element,{style:{height:j-40,overflow:"scroll"},children:Object(f.jsx)(xi,{children:Object(f.jsx)(u.LoremIpsum,{p:5})})})]})}),Object(f.jsxs)("div",{style:{flexGrow:1},children:[Object(f.jsx)(Gt,{title:"Tool properties"}),Object(f.jsx)(l.Element,{style:{height:F-j-40,overflow:"scroll"},children:Object(f.jsx)(Ji,{})})]})]})}),Object(f.jsxs)("div",{style:{position:"absolute",top:"0",height:"100%",width:"calc(100% - ".concat(a,"px - ").concat(x,"px)"),marginLeft:"".concat(a,"px"),marginRight:"".concat(x,"px"),overflow:"auto",display:"flex",flexFlow:"column"},children:[Object(f.jsx)("div",{style:{width:"100%"},children:Object(f.jsx)(yi,{})}),Object(f.jsx)("div",{style:{flexGrow:1},children:Object(f.jsx)(Gi,{})})]}),Object(f.jsx)("div",{children:Object(f.jsx)(c.Resizable,{style:{position:"absolute",top:"0",right:"0",float:"left"},width:x,height:k,resizeHandles:["w"],handle:Object(f.jsx)("div",{style:{position:"absolute",left:"0",top:"0",width:"10px",height:"100%",float:"right"}}),onResize:function(e,t){t.element;var i=t.size;t.handle;i.width+a+300<A&&i.width>100&&w({widthRightHor:i.width,heightRightHor:i.height})},children:Object(f.jsxs)("div",{style:{width:x+"px",height:k+"px"},children:[Object(f.jsx)(c.Resizable,{style:{position:"relative"},width:P,height:T,resizeHandles:["s"],onResize:function(e,t){t.element;var i=t.size;t.handle;i.height>rn&&F-i.height>rn&&E({widthRightVer:i.width,heightRightVer:i.height})},handle:Object(f.jsx)("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"10px"}}),children:Object(f.jsxs)("div",{style:{width:P+"px",height:T+"px"},children:[Object(f.jsx)(Gt,{title:"Navigation tree"}),Object(f.jsx)(l.Element,{style:{height:T-40,overflow:"scroll"},children:Object(f.jsx)(Fi,{})})]})}),Object(f.jsxs)("div",{style:{flexGrow:1},children:[Object(f.jsx)(Gt,{title:"Object properties"}),Object(f.jsx)(l.Element,{style:{height:F-T-40,overflow:"scroll"},children:Object(f.jsx)(Zi,{})})]})]})})})]}),Object(f.jsx)(Ki,{})]})})})})})},cn=i(445),ln=i(97);var un=function(){var e=Object(n.useState)({primaryColor:"#ececec",backgroundColor:"#787878",accentColor:"#bce2e9",secondaryColor:"#444444"}),t=Object(o.a)(e,2),i=t[0],a=t[1];return Object(f.jsx)(cn.a,{backend:ln.HTML5Backend,children:Object(f.jsxs)(b.Provider,{value:{colorMode:i,setColorMode:a},children:[v(i),Object(f.jsx)(on,{})]})})};r.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(un,{})}),document.getElementById("root"))}},[[412,1,2]]]);
//# sourceMappingURL=main.bd79a8bd.chunk.js.map